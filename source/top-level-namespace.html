<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Top Level Namespace
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!top-level-namespace.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo;
    
    
    <span class="title">Top Level Namespace</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Top Level Namespace
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
</dl>
<div class="clear"></div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="CTable.html" title="CTable (class)">CTable</a></span>, <span class='object_link'><a href="Matrix.html" title="Matrix (class)">Matrix</a></span>, <span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span>, <span class='object_link'><a href="RVariable.html" title="RVariable (class)">RVariable</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#add_codes_to_column-instance_method" title="#add_codes_to_column (instance method)">- (Object) <strong>add_codes_to_column</strong>(var, *args) </a>
    

    
      (also: #add_args_to_var, #addCodesToColumn, #addArgsToVar)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: add_codes_to_column Function: Add new
codes to a column Arguments: =&gt; var (required): The variable to add args
to.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#check_datavyu_version-instance_method" title="#check_datavyu_version (instance method)">- (Boolean) <strong>check_datavyu_version</strong>(minVersion, maxVersion = nil) </a>
    

    
      (also: #checkDatavyuVersion)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check whether current Datavyu version falls within the specified minimum
and maximum versions (inclusive).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#check_reliability-instance_method" title="#check_reliability (instance method)">- (Object) <strong>check_reliability</strong>(main_col, rel_col, match_arg, time_tolerance, *dump_file) </a>
    

    
      (also: #checkReliability, #check_rel, #checkRel)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: check_rel Function: Do a quick, in
Datavyu, check of reliability errors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#check_valid_codes-instance_method" title="#check_valid_codes (instance method)">- (Object) <strong>check_valid_codes</strong>(var, dump_file, *arg_code_pairs) </a>
    

    
      (also: #checkValidCodes)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: check_valid_codes Function: Do a
quick, in Datavyu, check of valid codes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#check_valid_codes2-instance_method" title="#check_valid_codes2 (instance method)">- (Object) <strong>check_valid_codes2</strong>(var, dump_file, *arg_filt_pairs) </a>
    

    
      (also: #checkValidCodes2)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check valid codes on cells in a column using regex.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#combine_columns-instance_method" title="#combine_columns (instance method)">- (Object) <strong>combine_columns</strong>(name, varnames) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#create_mutually_exclusive-instance_method" title="#create_mutually_exclusive (instance method)">- (Object) <strong>create_mutually_exclusive</strong>(name, var1name, var2name, var1_argprefix = nil, var2_argprefix = nil) </a>
    

    
      (also: #createMutuallyExclusive)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Combine two columns into a third column.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#create_new_column-instance_method" title="#create_new_column (instance method)">- (Object) <strong>create_new_column</strong>(name, *args) </a>
    

    
      (also: #createNewColumn, #createVariable, #createNewVariable, #create_column)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Function: Creates a brand new blank variable with argument *args and name
name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#delete_cell-instance_method" title="#delete_cell (instance method)">- (nil) <strong>delete_cell</strong>(cell) </a>
    

    
      (also: #deleteCell)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete a cell from the spreadsheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#delete_column-instance_method" title="#delete_column (instance method)">- (Object) <strong>delete_column</strong>(colname) </a>
    

    
      (also: #deleteColumn, #delete_variable, #deleteVariable)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#fillMutexCell-instance_method" title="#fillMutexCell (instance method)">- (Object) <strong>fillMutexCell</strong>(v1cell, v2cell, cell, mutex, var1_argprefix, var2_argprefix) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>:nodoc:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#fix_one_off_cells-instance_method" title="#fix_one_off_cells (instance method)">- (Object) <strong>fix_one_off_cells</strong>(col1, col2) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>:nodoc:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_cell_from_time-instance_method" title="#get_cell_from_time (instance method)">- (RCell) <strong>get_cell_from_time</strong>(col, time) </a>
    

    
      (also: #getCellFromTime)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a cell that is within the given millisecond timestamp from the
specified column.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_column-instance_method" title="#get_column (instance method)">- (Object) <strong>get_column</strong>(name) </a>
    

    
      (also: #getVariable, #getColumn)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Function: Retrieve a variable from the database and print_debug it into a
Ruby object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_column_list-instance_method" title="#get_column_list (instance method)">- (Array) <strong>get_column_list</strong> </a>
    

    
      (also: #getColumnList, #getVariableList)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a list of columns from the current spreadsheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_datavyu_version-instance_method" title="#get_datavyu_version (instance method)">- (String) <strong>get_datavyu_version</strong> </a>
    

    
      (also: #getDatavyuVersion)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return Datavyu version string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_later_overlapping_cell-instance_method" title="#get_later_overlapping_cell (instance method)">- (Object) <strong>get_later_overlapping_cell</strong>(col) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>:nodoc:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_os-instance_method" title="#get_os (instance method)">- (&#39;windows&#39;, ...) <strong>get_os</strong> </a>
    

    
      (also: #getOS)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Function: Return the OS version Example:  filepath = (getOS() ==
&#39;windows&#39;)? &#39;C:data&#39; : &#39;~/data&#39;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#load_db-instance_method" title="#load_db (instance method)">- (Object) <strong>load_db</strong>(filename) </a>
    

    
      (also: #loadDB)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: load_db Function: Loads a new database
from a file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#load_macshapa_db-instance_method" title="#load_macshapa_db (instance method)">- (Object) <strong>load_macshapa_db</strong>(filename, write_to_gui, *ignore_vars) </a>
    

    
      (also: #loadMacshapaDB)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: load_macshapa_db Function: Opens an
old, closed database format MacSHAPA file and loads     it into the current
open database.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#make_reliability-instance_method" title="#make_reliability (instance method)">- (Object) <strong>make_reliability</strong>(relname, var_to_copy, multiple_to_keep, *args_to_keep) </a>
    

    
      (also: #makeReliability, #make_rel)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: make_rel Function: This function will
create a reliability column that is a copy           of another column in
the database, copying every nth cell and           carrying over some of
the arguments from the original, if wanted.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#makeDurationBlockRel-instance_method" title="#makeDurationBlockRel (instance method)">- (Object) <strong>makeDurationBlockRel</strong>(relname, var_to_copy, binding, block_dur, skip_blocks) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: makeDurationBlockRel Function: Makes a
duration based reliability column based on John&#39;s method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#print_cell_codes-instance_method" title="#print_cell_codes (instance method)">- (Object) <strong>print_cell_codes</strong>(cell) </a>
    

    
      (also: #printCellCodes, #printCellArgs)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Prints ordinal, onset, offset, and the values of all codes from the given
cell.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#print_codes-instance_method" title="#print_codes (instance method)">- (Object) <strong>print_codes</strong>(cell, file, args) </a>
    

    
      (also: #print_args)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Outputs the values of all codes specified from the given cell to the given
output file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (instance method)">- (Object) <strong>print_debug</strong>(*s) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#print_err-instance_method" title="#print_err (instance method)">- (Object) <strong>print_err</strong>(m_cell, r_cell, arg, dump_file, main_col, rel_col) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define interal function for printing errors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#print_no_column_found_warning-instance_method" title="#print_no_column_found_warning (instance method)">- (Object) <strong>print_no_column_found_warning</strong>(colName) </a>
    

    
      (also: #printNoColumnFoundWarning)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Let the user know that a given column was not found.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#save_db-instance_method" title="#save_db (instance method)">- (Object) <strong>save_db</strong>(filename) </a>
    

    
      (also: #saveDB)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: save_db Function: Saves the current
$db and $pj variables to filename.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#scan_for_bad_cells-instance_method" title="#scan_for_bad_cells (instance method)">- (Object) <strong>scan_for_bad_cells</strong>(col) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>:nodoc:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#set_column-instance_method" title="#set_column (instance method)">- (Object) <strong>set_column</strong>(*args) </a>
    

    
      (also: #setVariable, #setColumn)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: setVariable Function: setVariable will
overwrite a variable in the database with the same name as the name
argument.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#set_column%21-instance_method" title="#set_column! (instance method)">- (Object) <strong>set_column!</strong>(*args) </a>
    

    
      (also: #setVariable!)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Deletes a variable from the spreadsheet and rebuilds it from the given
RVariable object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#smooth_column-instance_method" title="#smooth_column (instance method)">- (Object) <strong>smooth_column</strong>(colname, tol = 33) </a>
    

    
      (also: #smoothColumn)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#transfer_columns-instance_method" title="#transfer_columns (instance method)">- (Object) <strong>transfer_columns</strong>(db1, db2, remove, *varnames) </a>
    

    
      (also: #transfer_column, #transferColumns, #transferColumn, #transferVariables, #transferVariable)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>——————————————————————- Method name: transfer_columns Function: Transfers
columns between databases.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_codes_to_column-instance_method">
  
    - (<tt>Object</tt>) <strong>add_codes_to_column</strong>(var, *args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='add_args_to_var-instance_method'>add_args_to_var</span>, <span id='addCodesToColumn-instance_method'>addCodesToColumn</span>, <span id='addArgsToVar-instance_method'>addArgsToVar</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: add_codes_to_column Function: Add new codes to a column
Arguments:</p>

<h1 id="label-%3E+var+%28required%29%3A+The+variable+to+add+args+to.++This+can+be+a+name+or+a+variable+object.">&gt; var (required): The variable to add args to.  This can be a name or a variable object.</h1>

<h1 id="label-%3E+%2Aargs+%28required%29%3A+A+list+of+the+arguments+to+add+to+var+%28can+be+any+number+of+args%29">&gt; *args (required): A list of the arguments to add to var (can be any number of args)</h1>

<p>Returns:</p>

<h1 id="label-%3E+The+new+Ruby+representation+of+the+variable.++Write+it+back+to+the+database">&gt; The new Ruby representation of the variable.  Write it back to the database</h1>

<p>to save it.</p>

<p>Example: test = add_args_to_var(“test”, “arg1”, “arg2”, “arg3”)
setVariable(“test”,test)</p>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1134</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_codes_to_column'>add_codes_to_column</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_var_new'>var_new</span> <span class='op'>=</span> <span class='id identifier rubyid_createVariable'>createVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span> <span class='op'>+</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='id identifier rubyid_new_cell'>new_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_var_new'>var_new</span><span class='period'>.</span><span class='id identifier rubyid_make_new_cell'>make_new_cell</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_new_cell'>new_cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_new_cell'>new_cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
      <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_new_cell'>new_cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_var_new'>var_new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_datavyu_version-instance_method">
  
    - (<tt>Boolean</tt>) <strong>check_datavyu_version</strong>(minVersion, maxVersion = nil) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='checkDatavyuVersion-instance_method'>checkDatavyuVersion</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check whether current Datavyu version falls within the specified minimum
and maximum versions (inclusive)</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>minVersion</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Minimum version (e.g. &#39;v:1.3.5&#39;)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>maxVersion</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Maximum version. If unspecified, no upper bound is checked.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if min,max version check passes; false otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2383
2384
2385
2386
2387
2388
2389</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2383</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_datavyu_version'>check_datavyu_version</span><span class='lparen'>(</span><span class='id identifier rubyid_minVersion'>minVersion</span><span class='comma'>,</span> <span class='id identifier rubyid_maxVersion'>maxVersion</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_currentVersion'>currentVersion</span> <span class='op'>=</span> <span class='id identifier rubyid_getDatavyuVersion'>getDatavyuVersion</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_minCheck'>minCheck</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_minVersion'>minVersion</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_currentVersion'>currentVersion</span><span class='rparen'>)</span> <span class='op'>&lt;=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_maxCheck'>maxCheck</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_maxVersion'>maxVersion</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span><span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='lparen'>(</span><span class='id identifier rubyid_currentVersion'>currentVersion</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_maxVersion'>maxVersion</span><span class='rparen'>)</span> <span class='op'>&lt;=</span> <span class='int'>0</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_minCheck'>minCheck</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_maxCheck'>maxCheck</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_reliability-instance_method">
  
    - (<tt>Object</tt>) <strong>check_reliability</strong>(main_col, rel_col, match_arg, time_tolerance, *dump_file) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='checkReliability-instance_method'>checkReliability</span>, <span id='check_rel-instance_method'>check_rel</span>, <span id='checkRel-instance_method'>checkRel</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: check_rel Function: Do a quick, in Datavyu, check of
reliability errors. Arguments:</p>

<h1 id="label-%3E+main_col+%28required%29%3A+Either+the+string+name+or+the+Ruby+column+from+getVariable">&gt; main_col (required): Either the string name or the Ruby column from getVariable</h1>

<pre class="code ruby"><code class="ruby">of the primary column to compare against.</code></pre>

<h1 id="label-%3E+rel_col+%28required%29%3A+Either+the+string+name+or+the+Ruby+column+from+getVariable">&gt; rel_col (required): Either the string name or the Ruby column from getVariable</h1>

<pre class="code ruby"><code class="ruby">of the reliability column to compare to the primary column.</code></pre>

<h1 id="label-%3E+match_arg+%28required%29%3A+The+string+of+the+argument+to+use+to+match+the+relability">&gt; match_arg (required): The string of the argument to use to match the relability</h1>

<pre class="code ruby"><code class="ruby">cells to the primary cells.  This must be a unique identifier between the cells.</code></pre>

<h1 id="label-%3E+time_tolerance+%28required%29%3A+The+amount+of+slack+you+allow%2C+in+milliseconds%2C+for">&gt; time_tolerance (required): The amount of slack you allow, in milliseconds, for</h1>

<pre class="code ruby"><code class="ruby">difference between onset and offset before it is considered an error.  Set to 0
for no difference allowed and to a very large number for infinite distance allowed.</code></pre>

<h1 id="label-%3E+dump_file+%28optional%29%3A+The+full+string+path+to+dump+the+relability+output+to.++This">&gt; dump_file (optional): The full string path to dump the relability output to.  This</h1>

<pre class="code ruby"><code class="ruby">can be used for multi-file dumps or just to keep a log.  You can also give it a Ruby
File object if a file is already started.</code></pre>

<p>Returns:</p>

<h1 id="label-%3E+Nothing+but+the+console+and+file+output.">&gt; Nothing but the console and file output.</h1>

<p>Example:</p>

<pre class="code ruby"><code class="ruby">check_rel(&quot;trial&quot;, &quot;rel.trial&quot;, &quot;trialnum&quot;, 100, &quot;/Users/motoruser/Desktop/Relcheck.txt&quot;)
 or
check_rel(&quot;trial&quot;, &quot;rel.trial&quot;, &quot;trialnum&quot;, 100)</code></pre>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2015
2016
2017
2018
2019
2020
2021
2022
2023
2024
2025
2026
2027
2028
2029
2030
2031
2032
2033
2034
2035
2036
2037
2038
2039
2040
2041
2042
2043
2044
2045
2046
2047
2048
2049
2050
2051
2052
2053
2054
2055
2056
2057
2058
2059
2060
2061
2062
2063
2064
2065
2066
2067
2068
2069
2070
2071
2072
2073
2074
2075
2076
2077
2078
2079
2080
2081
2082
2083
2084
2085
2086
2087
2088
2089
2090
2091
2092
2093
2094
2095
2096</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2015</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_reliability'>check_reliability</span><span class='lparen'>(</span><span class='id identifier rubyid_main_col'>main_col</span><span class='comma'>,</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='comma'>,</span> <span class='id identifier rubyid_match_arg'>match_arg</span><span class='comma'>,</span> <span class='id identifier rubyid_time_tolerance'>time_tolerance</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_dump_file'>dump_file</span><span class='rparen'>)</span>
  <span class='comment'># Make the match_arg conform to the method format that is used
</span>  <span class='kw'>if</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>3</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>4</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>6</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>7</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>8</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>9</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_match_arg'>match_arg</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_chr'>chr</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_match_arg'>match_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_match_arg'>match_arg</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_match_arg'>match_arg</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_match_arg'>match_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_match_arg'>match_arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>

  <span class='comment'># Set up our method variables
</span>  <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>=</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    <span class='id identifier rubyid_main_col'>main_col</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_main_col'>main_col</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    <span class='id identifier rubyid_rel_col'>rel_col</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_rel_col'>rel_col</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_printing'>printing</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>!=</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
      <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_printing'>printing</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='comment'># Define interal function for printing errors
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_print_err'>print_err</span><span class='lparen'>(</span><span class='id identifier rubyid_m_cell'>m_cell</span><span class='comma'>,</span> <span class='id identifier rubyid_r_cell'>r_cell</span><span class='comma'>,</span> <span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='comma'>,</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_main_val'>main_val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m_cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_rel_val'>rel_val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r_cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_err_str'>err_str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ERROR in </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> at Ordinal </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_m_cell'>m_cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, rel ordinal </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_r_cell'>r_cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> in argument </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_arg'>arg</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_main_val'>main_val</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_rel_val'>rel_val</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>!=</span> <span class='kw'>nil</span>
      <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_err_str'>err_str</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_err_str'>err_str</span>
  <span class='kw'>end</span>

  <span class='comment'># Build error array
</span>  <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
    <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_arg'>arg</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='comment'># Now check the cells
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_mc'>mc</span> <span class='kw'>in</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='id identifier rubyid_main_bind'>main_bind</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mc.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_match_arg'>match_arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>for</span> <span class='id identifier rubyid_rc'>rc</span> <span class='kw'>in</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
      <span class='id identifier rubyid_rel_bind'>rel_bind</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rc.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_match_arg'>match_arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_main_bind'>main_bind</span> <span class='op'>==</span> <span class='id identifier rubyid_rel_bind'>rel_bind</span>
        <span class='comment'># Then check these cells match, check them for errors
</span>        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_mc'>mc</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>-</span> <span class='id identifier rubyid_rc'>rc</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_time_tolerance'>time_tolerance</span>
          <span class='id identifier rubyid_print_err'>print_err</span><span class='lparen'>(</span><span class='id identifier rubyid_mc'>mc</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='comma'>,</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='int'>1</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_mc'>mc</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>-</span> <span class='id identifier rubyid_rc'>rc</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_time_tolerance'>time_tolerance</span>
          <span class='id identifier rubyid_print_err'>print_err</span><span class='lparen'>(</span><span class='id identifier rubyid_mc'>mc</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='comma'>,</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='int'>1</span>
        <span class='kw'>end</span>

        <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
          <span class='id identifier rubyid_main_val'>main_val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mc.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_rel_val'>rel_val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rc.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>if</span> <span class='id identifier rubyid_main_val'>main_val</span> <span class='op'>!=</span> <span class='id identifier rubyid_rel_val'>rel_val</span>
            <span class='id identifier rubyid_print_err'>print_err</span><span class='lparen'>(</span><span class='id identifier rubyid_mc'>mc</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span><span class='comma'>,</span> <span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='comma'>,</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_arg'>arg</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='id identifier rubyid_arg'>arg</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='int'>1</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_errs'>errs</span> <span class='kw'>in</span> <span class='id identifier rubyid_errors'>errors</span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Total errors for </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_arg'>arg</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_errs'>errs</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, Agreement:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.2f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lparen'>(</span><span class='int'>100</span> <span class='op'>*</span> <span class='lparen'>(</span><span class='float'>1.0</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_errs'>errs</span> <span class='op'>/</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_str'>str</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>!=</span> <span class='kw'>nil</span>
      <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_errors'>errors</span><span class='comma'>,</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_valid_codes-instance_method">
  
    - (<tt>Object</tt>) <strong>check_valid_codes</strong>(var, dump_file, *arg_code_pairs) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='checkValidCodes-instance_method'>checkValidCodes</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: check_valid_codes Function: Do a quick, in Datavyu, check of
valid codes. Arguments:</p>

<h1 id="label-%3E+val+%28required%29%3A+The+variable+that+the+codes+belong+to.">&gt; val (required): The variable that the codes belong to.</h1>

<h1 id="label-%3E+dump_file+%28required%29%3A+The+full+path+of+the+file+to+dump+output+to.">&gt; dump_file (required): The full path of the file to dump output to.</h1>

<pre class="code ruby"><code class="ruby">Use &quot;&quot; to not dump to a file.  You may also pass a Ruby File object.</code></pre>

<h1 id="label-%3E+arg_code_pairs+%28required%29%3A+A+list+of+the+argument+names+and+valid+codes">&gt; arg_code_pairs (required): A list of the argument names and valid codes</h1>

<pre class="code ruby"><code class="ruby">in the following format: &quot;argument_name&quot;, [&quot;y&quot;,&quot;n&quot;], &quot;argument2&quot;, [&quot;j&quot;,&quot;k&quot;,&quot;m&quot;]</code></pre>

<p>Returns:</p>

<h1 id="label-%3E+Nothing+but+the+console+and+file+output.">&gt; Nothing but the console and file output.</h1>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_check_valid_codes'>check_valid_codes</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trial</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hand</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>l</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>turn</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>l</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unit</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2116
2117
2118
2119
2120
2121
2122
2123
2124
2125
2126
2127
2128
2129
2130
2131
2132
2133
2134
2135
2136
2137
2138
2139
2140
2141
2142
2143
2144
2145
2146
2147
2148
2149
2150
2151
2152
2153
2154
2155
2156
2157
2158
2159
2160
2161
2162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2116</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_valid_codes'>check_valid_codes</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_arg_code_pairs'>arg_code_pairs</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
      <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Make the argument/code hash
</span>  <span class='id identifier rubyid_arg_code'>arg_code</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_arg_code_pairs'>arg_code_pairs</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>%</span> <span class='int'>2</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_arg_code_pairs'>arg_code_pairs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FATAL ERROR in argument/valid code array.  Exiting.  Please check to make sure it is in the format &quot;argumentname&quot;, [&quot;valid&quot;,&quot;codes&quot;]</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_exit'>exit</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_code_pairs'>arg_code_pairs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>3</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>4</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>6</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>7</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>8</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>9</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_chr'>chr</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W )+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>

      <span class='id identifier rubyid_arg_code'>arg_code</span><span class='lbracket'>[</span><span class='id identifier rubyid_arg'>arg</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_code_pairs'>arg_code_pairs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_code'>code</span> <span class='kw'>in</span> <span class='id identifier rubyid_arg_code'>arg_code</span>
      <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_code'>code</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Code ERROR: Var: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tOrdinal: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tArg: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_arg'>arg</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tVal: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_str'>str</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_errors'>errors</span>
    <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No errors found.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_valid_codes2-instance_method">
  
    - (<tt>Object</tt>) <strong>check_valid_codes2</strong>(var, dump_file, *arg_filt_pairs) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='checkValidCodes2-instance_method'>checkValidCodes2</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check valid codes on cells in a column using regex. Backwards-compatible
with checkValidCodes call-seq:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_check_valid_codes2'>check_valid_codes2</span><span class='lparen'>(</span><span class='id identifier rubyid_column'>column</span><span class='comma'>,</span> <span class='id identifier rubyid_outfile'>outfile</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_code_filter_pairs'>code_filter_pairs</span><span class='rparen'>)</span></code></pre>

<p>Arguments:</p>

<pre class="code ruby"><code class="ruby">* val (required): The variable that the codes belong to.
* dump_file (required): The full path of the file to dump output to.
 Use &quot;&quot; to not dump to a file.  You may also pass a Ruby File object.
* arg_filt_pairs (required): Pairs of code name and acceptable values either as an array of values or regexp</code></pre>

<p>Returns:</p>

<pre class="code ruby"><code class="ruby">* Nothing (output is printed to file or console).</code></pre>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_checkValidCodes2'>checkValidCodes2</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trial</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hand</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>l</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>turn</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>l</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unit</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A\d+\Z</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2179
2180
2181
2182
2183
2184
2185
2186
2187
2188
2189
2190
2191
2192
2193
2194
2195
2196
2197
2198
2199
2200
2201
2202
2203
2204
2205
2206
2207
2208
2209
2210
2211
2212
2213
2214
2215
2216
2217
2218
2219
2220
2221
2222
2223
2224
2225
2226
2227
2228
2229
2230
2231
2232
2233
2234
2235
2236
2237
2238
2239
2240
2241
2242
2243
2244
2245
2246
2247
2248
2249
2250
2251</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_valid_codes2'>check_valid_codes2</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_arg_filt_pairs'>arg_filt_pairs</span><span class='rparen'>)</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
		<span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>Hash</span>
    <span class='comment'># var is already a hashmap
</span>    <span class='id identifier rubyid_map'>map</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
	    	<span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_dump_file'>dump_file</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
	  	<span class='kw'>end</span>
	<span class='kw'>end</span>

  <span class='comment'># Create a map if a mapping wasn&#39;t passed in. Mostly for backwards compatibility with checkValidCodes().
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_map'>map</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  	<span class='comment'># Make the argument/code hash
</span>  	<span class='id identifier rubyid_arg_code'>arg_code</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  	<span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_arg_filt_pairs'>arg_filt_pairs</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  	  <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>%</span> <span class='int'>2</span> <span class='op'>==</span> <span class='int'>0</span>
    		<span class='kw'>if</span> <span class='id identifier rubyid_arg_filt_pairs'>arg_filt_pairs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    			<span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FATAL ERROR in argument/valid code array.  Exiting.  Please check to make sure it is in the format &quot;argumentname&quot;, [&quot;valid&quot;,&quot;codes&quot;]</span><span class='tstring_end'>&#39;</span></span>
    			<span class='id identifier rubyid_exit'>exit</span>
    		<span class='kw'>end</span>

    		<span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_filt_pairs'>arg_filt_pairs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    		<span class='kw'>if</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>3</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>4</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>6</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>7</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>8</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>9</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_chr'>chr</span><span class='rparen'>)</span>
    			<span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span>
    		<span class='kw'>end</span>
    		<span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W )+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>

  	    <span class='comment'># Add the filter for this code.  If the given filter is an array, convert it to a regular expression using Regex.union
</span>        <span class='id identifier rubyid_arg_code'>arg_code</span><span class='lbracket'>[</span><span class='id identifier rubyid_arg'>arg</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_filt_pairs'>arg_filt_pairs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span>
  	  <span class='kw'>end</span>
  	<span class='kw'>end</span>

    <span class='id identifier rubyid_map'>map</span><span class='lbracket'>[</span><span class='id identifier rubyid_var'>var</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_code'>arg_code</span>
  <span class='kw'>end</span>

	<span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='comment'># Iterate over key,entry (column, valid code mapping) in map
</span>  <span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_arg_code'>arg_code</span><span class='op'>|</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>String</span>

    <span class='comment'># Iterate over cells in var and check each code&#39;s value
</span>  	<span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
  		<span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_filt'>filt</span> <span class='kw'>in</span> <span class='id identifier rubyid_arg_code'>arg_code</span>
        	<span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='comment'># Check whether value is valid — different functions depending on filter type
</span>          <span class='id identifier rubyid_valid'>valid</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='comment'># note: we can&#39;t use case on filt.class because case uses === for comparison
</span>          <span class='kw'>when</span> <span class='id identifier rubyid_filt'>filt</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>Regexp</span>
          	<span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_filt'>filt</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='kw'>when</span> <span class='id identifier rubyid_filt'>filt</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>Array</span>
            <span class='id identifier rubyid_filt'>filt</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
          <span class='kw'>else</span>
            <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unhandled filter type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filt'>filt</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>

          <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_valid'>valid</span>
            <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='kw'>true</span>
            <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Code ERROR: Var: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tOrdinal: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tArg: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_arg'>arg</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tVal: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_str'>str</span>
            <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
      	<span class='kw'>end</span>
  	<span class='kw'>end</span>
  <span class='kw'>end</span>
	<span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_errors'>errors</span>
  	<span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No errors found.</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="combine_columns-instance_method">
  
    - (<tt>Object</tt>) <strong>combine_columns</strong>(name, varnames) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1158
1159
1160
1161
1162
1163
1164
1165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_combine_columns'>combine_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_varnames'>varnames</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_stationary_var'>stationary_var</span> <span class='op'>=</span> <span class='id identifier rubyid_varnames'>varnames</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>1</span><span class='op'>...</span><span class='id identifier rubyid_varnames'>varnames</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
    <span class='id identifier rubyid_next_var'>next_var</span> <span class='op'>=</span> <span class='id identifier rubyid_varnames'>varnames</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_create_mutually_exclusive'>create_mutually_exclusive</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_stationary_var'>stationary_var</span><span class='comma'>,</span> <span class='id identifier rubyid_next_var'>next_var</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_var'>var</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mutually_exclusive-instance_method">
  
    - (<tt>Object</tt>) <strong>create_mutually_exclusive</strong>(name, var1name, var2name, var1_argprefix = nil, var2_argprefix = nil) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='createMutuallyExclusive-instance_method'>createMutuallyExclusive</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Combine two columns into a third column. The new column&#39;s code list is
a union of the original two columns with a prefix added to each code name.
The default prefix is the name of the source column (e.g. column “task”
code “ordinal” becomes “task_ordinal”) Create a new column from two others,
mixing their cells together</p>

<pre class="code ruby"><code class="ruby">such that the new variable has all of the arguments of both other variables
and a new cell for each overlap and mixture of the two cells.</code></pre>

<p>Arguments:</p>

<pre class="code ruby"><code class="ruby">name (required): The name of the new variable.
var1name (required): Name of the first variable to be mutexed.
var2name (required): Name of the second variable to be mutexed.</code></pre>

<p>Returns:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>The</span> <span class='id identifier rubyid_new'>new</span> <span class='const'>Ruby</span> <span class='id identifier rubyid_representation'>representation</span> <span class='id identifier rubyid_of'>of</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span>  <span class='const'>Write</span> <span class='id identifier rubyid_it'>it</span> <span class='id identifier rubyid_back'>back</span> <span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_the'>the</span> <span class='id identifier rubyid_database'>database</span></code></pre>

<p>to save it.</p>

<p>Example: test = create_mutually_exclusive(“test”, “var1”, “var2”)
setVariable(“test”,test)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380
1381
1382
1383
1384
1385
1386
1387
1388
1389
1390
1391
1392
1393
1394
1395
1396
1397
1398
1399
1400
1401
1402
1403
1404
1405
1406
1407
1408
1409
1410
1411
1412
1413
1414
1415
1416
1417
1418
1419
1420
1421
1422
1423
1424
1425
1426
1427
1428
1429
1430
1431
1432
1433
1434
1435
1436
1437
1438
1439
1440
1441
1442
1443
1444
1445
1446
1447
1448
1449</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1256</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mutually_exclusive'>create_mutually_exclusive</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_var1name'>var1name</span><span class='comma'>,</span> <span class='id identifier rubyid_var2name'>var2name</span><span class='comma'>,</span> <span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var1name'>var1name</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    <span class='id identifier rubyid_var1'>var1</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var1name'>var1name</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_var1'>var1</span> <span class='op'>=</span> <span class='id identifier rubyid_var1name'>var1name</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var2name'>var2name</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    <span class='id identifier rubyid_var2'>var2</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var2name'>var2name</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_var2'>var2</span> <span class='op'>=</span> <span class='id identifier rubyid_var2name'>var2name</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_scan_for_bad_cells'>scan_for_bad_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_var1'>var1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scan_for_bad_cells'>scan_for_bad_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_var2'>var2</span><span class='rparen'>)</span>

  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ERROR: CELL IN </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> ORD: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HAS BLANK OFFSET, EXITING</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_exit'>exit</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ERROR: CELL IN </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> ORD: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HAS BLANK OFFSET, EXITING</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_exit'>exit</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Handle special cases where one or both of columns have no cells
</span>
  <span class='comment'># Handle special case where column has a cell with negative time
</span>
  <span class='comment'># Get the earliest time between the two cols
</span>  <span class='id identifier rubyid_time1_on'>time1_on</span> <span class='op'>=</span> <span class='int'>9999999999</span>
  <span class='id identifier rubyid_time2_on'>time2_on</span> <span class='op'>=</span> <span class='int'>9999999999</span>

  <span class='id identifier rubyid_time1_off'>time1_off</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_time2_off'>time2_off</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_time1_on'>time1_on</span> <span class='op'>=</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
    <span class='id identifier rubyid_time1_off'>time1_off</span> <span class='op'>=</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_time2_on'>time2_on</span> <span class='op'>=</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
    <span class='id identifier rubyid_time2_off'>time2_off</span> <span class='op'>=</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_start_time'>start_time</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_time1_on'>time1_on</span><span class='comma'>,</span> <span class='id identifier rubyid_time2_on'>time2_on</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>

  <span class='comment'># And the end time
</span>  <span class='id identifier rubyid_end_time'>end_time</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_time1_off'>time1_off</span><span class='comma'>,</span> <span class='id identifier rubyid_time2_off'>time2_off</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>


  <span class='comment'># Create the new variable
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span> <span class='op'>==</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span> <span class='op'>=</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>___</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span> <span class='op'>==</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span> <span class='op'>=</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>___</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_v1arglist'>v1arglist</span> <span class='op'>=</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span> <span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span> <span class='op'>+</span> <span class='id identifier rubyid_arg'>arg</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_v2arglist'>v2arglist</span> <span class='op'>=</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span> <span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span> <span class='op'>+</span> <span class='id identifier rubyid_arg'>arg</span> <span class='rbrace'>}</span>

  <span class='comment'># puts &quot;NEW ARGUMENT NAMES:&quot;, v1arglist, v2arglist
</span>  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ordinal</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>+=</span> <span class='id identifier rubyid_v1arglist'>v1arglist</span>

  <span class='id identifier rubyid_args'>args</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ordinal</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>+=</span> <span class='id identifier rubyid_v2arglist'>v2arglist</span>

  <span class='comment'># puts &quot;Creating mutex var&quot;, var1.arglist
</span>  <span class='id identifier rubyid_mutex'>mutex</span> <span class='op'>=</span> <span class='id identifier rubyid_createVariable'>createVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='comment'># puts &quot;Mutex var created&quot;
</span>
  <span class='comment'># And finally begin creating new cells
</span>  <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_next_v1cell_ind'>next_v1cell_ind</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_next_v2cell_ind'>next_v2cell_ind</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_time'>time</span> <span class='op'>=</span> <span class='id identifier rubyid_start_time'>start_time</span>
  <span class='comment'># puts &quot;Start time&quot;, start_time
</span>  <span class='comment'># puts &quot;End time&quot;, end_time
</span>
  <span class='id identifier rubyid_flag'>flag</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='comment'>#######################
</span>  <span class='comment'># BEGIN NEW MUTEX
</span>  <span class='comment'># Idea here: gather all of the time changes.
</span>  <span class='comment'># For each time change get the corresponding cells involved in that change.
</span>  <span class='comment'># Create the necessary cell at each time change.
</span>  <span class='comment'>#######################
</span>
  <span class='id identifier rubyid_time_changes'>time_changes</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_v1_cells_at_time'>v1_cells_at_time</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_v2_cells_at_time'>v2_cells_at_time</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>


  <span class='comment'># Preprocess relevant cells and times
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span> <span class='op'>+</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='id identifier rubyid_time_changes'>time_changes</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_time_changes'>time_changes</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
  <span class='kw'>end</span>


  <span class='id identifier rubyid_time_changes'>time_changes</span> <span class='op'>=</span> <span class='id identifier rubyid_time_changes'>time_changes</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
  <span class='kw'>if</span> <span class='gvar'>$debug</span>
    <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_time_changes'>time_changes</span>
  <span class='kw'>end</span>
  <span class='comment'># p time_changes
</span>

  <span class='id identifier rubyid_mutex_cell'>mutex_cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_mutex_cell_parent'>mutex_cell_parent</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='comment'># TODO: make these handle empty cols
</span>  <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>=</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_prev_v1cell'>prev_v1cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_prev_v2cell'>prev_v2cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>=</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_v1idx'>v1idx</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_v2idx'>v2idx</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='comment'>#
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_time_changes'>time_changes</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>2</span>
    <span class='id identifier rubyid_t0'>t0</span> <span class='op'>=</span> <span class='id identifier rubyid_time_changes'>time_changes</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_t1'>t1</span> <span class='op'>=</span> <span class='id identifier rubyid_time_changes'>time_changes</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span>

    <span class='comment'># Find the cells that are active during these times
</span>    <span class='kw'>for</span> <span class='id identifier rubyid_j'>j</span> <span class='kw'>in</span> <span class='id identifier rubyid_v1idx'>v1idx</span><span class='op'>..</span><span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_var1'>var1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>if</span> <span class='gvar'>$debug</span>
        <span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>---</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>T1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_t0'>t0</span><span class='comma'>,</span> <span class='id identifier rubyid_t1'>t1</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>---</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_t0'>t0</span> <span class='kw'>and</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_t1'>t1</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_t1'>t1</span><span class='op'>-</span><span class='id identifier rubyid_t0'>t0</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='kw'>or</span> <span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='op'>==</span><span class='id identifier rubyid_t0'>t0</span> <span class='kw'>and</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='op'>==</span><span class='id identifier rubyid_t1'>t1</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
        <span class='id identifier rubyid_v1idx'>v1idx</span> <span class='op'>=</span> <span class='id identifier rubyid_j'>j</span>
        <span class='comment'># p t0, t1, &quot;Found V1&quot;
</span>        <span class='kw'>break</span>
        <span class='comment'># elsif c.onset &gt; t1
</span>        <span class='comment'>#   break
</span>      <span class='kw'>else</span>
        <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>for</span> <span class='id identifier rubyid_j'>j</span> <span class='kw'>in</span> <span class='id identifier rubyid_v2idx'>v2idx</span><span class='op'>..</span><span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_var2'>var2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='comment'># p &quot;---&quot;, &quot;T2&quot;, t0, t1, c.onset, c.offset, &quot;---&quot;
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_t0'>t0</span> <span class='kw'>and</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_t1'>t1</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_t1'>t1</span><span class='op'>-</span><span class='id identifier rubyid_t0'>t0</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='kw'>or</span> <span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='op'>==</span><span class='id identifier rubyid_t0'>t0</span> <span class='kw'>and</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='op'>==</span><span class='id identifier rubyid_t1'>t1</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
        <span class='id identifier rubyid_v2idx'>v2idx</span> <span class='op'>=</span> <span class='id identifier rubyid_j'>j</span>
        <span class='comment'># p t0, t1, &quot;Found V2&quot;
</span>        <span class='kw'>break</span>
        <span class='comment'># elsif c.onset &gt; t1
</span>        <span class='comment'>#   break
</span>      <span class='kw'>else</span>
        <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='kw'>or</span> <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>!=</span> <span class='kw'>nil</span>
      <span class='id identifier rubyid_mutex_cell'>mutex_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_create_cell'>create_cell</span>

      <span class='id identifier rubyid_mutex_cell'>mutex_cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_t0'>t0</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_mutex_cell'>mutex_cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_t1'>t1</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fillMutexCell'>fillMutexCell</span><span class='lparen'>(</span><span class='id identifier rubyid_v1cell'>v1cell</span><span class='comma'>,</span> <span class='id identifier rubyid_v2cell'>v2cell</span><span class='comma'>,</span> <span class='id identifier rubyid_mutex_cell'>mutex_cell</span><span class='comma'>,</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='comma'>,</span> <span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='comma'>,</span> <span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>


  <span class='comment'># Now that we have all of the necessary temporal information
</span>  <span class='comment'># go through each time in the list and create a cell
</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
    <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_change_arg_name'>change_arg_name</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>___</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ordinal</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Created a column with </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> cells.</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>return</span> <span class='id identifier rubyid_mutex'>mutex</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_new_column-instance_method">
  
    - (<tt>Object</tt>) <strong>create_new_column</strong>(name, *args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='createNewColumn-instance_method'>createNewColumn</span>, <span id='createVariable-instance_method'>createVariable</span>, <span id='createNewVariable-instance_method'>createNewVariable</span>, <span id='create_column-instance_method'>create_column</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Function: Creates a brand new blank variable with argument *args and name
name. Arguments:</p>

<pre class="code ruby"><code class="ruby">name (required): The Datavyu name of the variable being retrieved
*args: (optional): List of arguments that the variable will contain.  Onset, Offset, and
            ordinal are created by default.</code></pre>

<p>Returns: A Ruby object representation of the variable inside Datavyu.
Usage:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_trial'>trial</span> <span class='op'>=</span> <span class='id identifier rubyid_createNewVariable'>createNewVariable</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trial</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trialnum</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unit</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_blank_cell'>blank_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_trial'>trial</span><span class='period'>.</span><span class='id identifier rubyid_make_new_cell'>make_new_cell</span><span class='lparen'>(</span><span class='rparen'>)</span>
<span class='id identifier rubyid_setVariable'>setVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_trial'>trial</span><span class='rparen'>)</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1015</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_new_column'>create_new_column</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Creating new variable</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='const'>RVariable</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>

  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_dirty'>dirty</span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>Array</span>
    <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_args'>args</span>

  <span class='comment'># Set the argument names in arg_names and set the database internal style with &lt;argname&gt; in old_args
</span>  <span class='id identifier rubyid_arg_names'>arg_names</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_old_args'>old_args</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_args'>args</span>
    <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_arg'>arg</span>
    <span class='id identifier rubyid_arg_names'>arg_names</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_arg'>arg</span>
    <span class='id identifier rubyid_old_args'>old_args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_old_args'>old_args</span> <span class='op'>=</span> <span class='id identifier rubyid_old_args'>old_args</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_arg_names'>arg_names</span><span class='rparen'>)</span>

  <span class='comment'># Return reference to this variable for the user
</span>  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Finished creating variable</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>return</span> <span class='id identifier rubyid_v'>v</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_cell-instance_method">
  
    - (<tt>nil</tt>) <strong>delete_cell</strong>(cell) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='deleteCell-instance_method'>deleteCell</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete a cell from the spreadsheet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cell</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2347
2348
2349</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2347</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_cell'>delete_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_removeCell'>removeCell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_column-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_column</strong>(colname) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='deleteColumn-instance_method'>deleteColumn</span>, <span id='delete_variable-instance_method'>delete_variable</span>, <span id='deleteVariable-instance_method'>deleteVariable</span></span>
    </span>
  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1602
1603
1604
1605
1606
1607
1608
1609
1610
1611</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1602</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_column'>delete_column</span><span class='lparen'>(</span><span class='id identifier rubyid_colname'>colname</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_colname'>colname</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
    <span class='id identifier rubyid_colname'>colname</span> <span class='op'>=</span> <span class='id identifier rubyid_colname'>colname</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_col'>col</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_colname'>colname</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_col'>col</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_printNoColumnFoundWarning'>printNoColumnFoundWarning</span><span class='lparen'>(</span><span class='id identifier rubyid_colname'>colname</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='gvar'>$db</span><span class='period'>.</span><span class='id identifier rubyid_removeVariable'>removeVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_col'>col</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fillMutexCell-instance_method">
  
    - (<tt>Object</tt>) <strong>fillMutexCell</strong>(v1cell, v2cell, cell, mutex, var1_argprefix, var2_argprefix) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1452
1453
1454
1455
1456
1457
1458
1459
1460
1461
1462
1463
1464
1465
1466
1467
1468
1469
1470
1471
1472
1473
1474
1475
1476
1477
1478
1479
1480
1481
1482
1483
1484
1485
1486</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1452</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fillMutexCell'>fillMutexCell</span><span class='lparen'>(</span><span class='id identifier rubyid_v1cell'>v1cell</span><span class='comma'>,</span> <span class='id identifier rubyid_v2cell'>v2cell</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='comma'>,</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='comma'>,</span> <span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='comma'>,</span> <span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='kw'>and</span> <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>!=</span> <span class='kw'>nil</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
      <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v1cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v2cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='kw'>elsif</span> <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='kw'>and</span> <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>==</span> <span class='kw'>nil</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
      <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_var1_argprefix'>var1_argprefix</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v1cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='kw'>elsif</span> <span class='id identifier rubyid_v1cell'>v1cell</span> <span class='op'>==</span> <span class='kw'>nil</span> <span class='kw'>and</span> <span class='id identifier rubyid_v2cell'>v2cell</span> <span class='op'>!=</span> <span class='kw'>nil</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
      <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_var2_argprefix'>var2_argprefix</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v2cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fix_one_off_cells-instance_method">
  
    - (<tt>Object</tt>) <strong>fix_one_off_cells</strong>(col1, col2) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1194</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fix_one_off_cells'>fix_one_off_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_col1'>col1</span><span class='comma'>,</span> <span class='id identifier rubyid_col2'>col2</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_col1'>col1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>2</span>
    <span class='id identifier rubyid_cell1'>cell1</span> <span class='op'>=</span> <span class='id identifier rubyid_col1'>col1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_j'>j</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>2</span>
      <span class='id identifier rubyid_cell2'>cell2</span> <span class='op'>=</span> <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span>

      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>-</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATING CELL</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CELL2 ONSET IS NOW </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_j'>j</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>==</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
          <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>-</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATING CELL</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CELL2 OFFSET IS NOW </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>==</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
          <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>-</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATING CELL</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CELL1 OFFSET IS NOW </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_col1'>col1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>==</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
          <span class='id identifier rubyid_col1'>col1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_col1'>col1</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>-</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATING CELL</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CELL2 OFFSET IS NOW </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>==</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
          <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_col2'>col2</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_cell_from_time-instance_method">
  
    - (<tt><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></tt>) <strong>get_cell_from_time</strong>(col, time) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='getCellFromTime-instance_method'>getCellFromTime</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a cell that is within the given millisecond timestamp from the
specified column.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2320
2321
2322
2323
2324
2325
2326
2327</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2320</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_cell_from_time'>get_cell_from_time</span><span class='lparen'>(</span><span class='id identifier rubyid_col'>col</span><span class='comma'>,</span> <span class='id identifier rubyid_time'>time</span><span class='rparen'>)</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_time'>time</span> <span class='kw'>and</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_time'>time</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_cell'>cell</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_column-instance_method">
  
    - (<tt>Object</tt>) <strong>get_column</strong>(name) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='getVariable-instance_method'>getVariable</span>, <span id='getColumn-instance_method'>getColumn</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Function: Retrieve a variable from the database and print_debug it into a
Ruby object. Arguments:</p>

<pre class="code ruby"><code class="ruby">name (required): The Datavyu name of the variable being retrieved</code></pre>

<p>Returns:</p>

<pre class="code ruby"><code class="ruby">A Ruby object representation of the variable inside Datavyu or nil if the named column does not exist.</code></pre>

<p>Usage:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_trial'>trial</span> <span class='op'>=</span> <span class='id identifier rubyid_get_column'>get_column</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trial</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 667</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_column'>get_column</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_printNoColumnFoundWarning'>printNoColumnFoundWarning</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># Convert each cell into an array and store in an array of arrays
</span>  <span class='id identifier rubyid_cells'>cells</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_getCells'>getCells</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_arg_names'>arg_names</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'># Now get the arguments for each of the cells
</span>
  <span class='comment'># For matrix vars only
</span>  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
    <span class='comment'># Matrix var
</span>    <span class='id identifier rubyid_arg_names'>arg_names</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_childArguments'>childArguments</span>
      <span class='id identifier rubyid_arg_names'>arg_names</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># Nominal or text
</span>    <span class='id identifier rubyid_arg_names'>arg_names</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>var</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='const'>RVariable</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_old_args'>old_args</span> <span class='op'>=</span> <span class='id identifier rubyid_arg_names'>arg_names</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_type'>type</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_cells'>cells</span><span class='comma'>,</span> <span class='id identifier rubyid_arg_names'>arg_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_sort_cells'>sort_cells</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_dirty'>dirty</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_v'>v</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_column_list-instance_method">
  
    - (<tt>Array</tt>) <strong>get_column_list</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='getColumnList-instance_method'>getColumnList</span>, <span id='getVariableList-instance_method'>getVariableList</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a list of columns from the current spreadsheet.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2256
2257
2258
2259
2260
2261
2262
2263
2264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2256</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_column_list'>get_column_list</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_name_list'>name_list</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_vars'>vars</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='period'>.</span><span class='id identifier rubyid_getAllVariables'>getAllVariables</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_v'>v</span> <span class='kw'>in</span> <span class='id identifier rubyid_vars'>vars</span>
    <span class='id identifier rubyid_name_list'>name_list</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_name_list'>name_list</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_datavyu_version-instance_method">
  
    - (<tt>String</tt>) <strong>get_datavyu_version</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='getDatavyuVersion-instance_method'>getDatavyuVersion</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return Datavyu version string.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Version string in the fromat “v.:#.#”</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2374
2375
2376</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2374</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_datavyu_version'>get_datavyu_version</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_org'>org</span><span class='period'>.</span><span class='id identifier rubyid_datavyu'>datavyu</span><span class='period'>.</span><span class='id identifier rubyid_util'>util</span><span class='period'>.</span><span class='const'>LocalVersion</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_later_overlapping_cell-instance_method">
  
    - (<tt>Object</tt>) <strong>get_later_overlapping_cell</strong>(col) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1181</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_later_overlapping_cell'>get_later_overlapping_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_col'>col</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_sort_cells'>sort_cells</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_overlapping_cells'>overlapping_cells</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='int'>2</span>
    <span class='id identifier rubyid_cell1'>cell1</span> <span class='op'>=</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_cell2'>cell2</span> <span class='op'>=</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='kw'>and</span> <span class='id identifier rubyid_cell1'>cell1</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_cell2'>cell2</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_overlapping_cells'>overlapping_cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell2'>cell2</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_overlapping_cells'>overlapping_cells</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_os-instance_method">
  
    - (<tt>'windows'</tt>, ...) <strong>get_os</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='getOS-instance_method'>getOS</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Function: Return the OS version Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_filepath'>filepath</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_getOS'>getOS</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>windows</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C:\data</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~/data</span><span class='tstring_end'>&#39;</span></span></code></pre>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>'windows'</tt>, <tt>'mac'</tt>, <tt>'linux'</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2356
2357
2358
2359
2360
2361
2362
2363
2364
2365
2366
2367
2368
2369</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2356</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_os'>get_os</span>
	<span class='id identifier rubyid_host_os'>host_os</span> <span class='op'>=</span> <span class='const'>RbConfig</span><span class='op'>::</span><span class='const'>CONFIG</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>host_os</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
	<span class='kw'>case</span> <span class='id identifier rubyid_host_os'>host_os</span>
	<span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>mswin|msys|mingw|cygwin|bccwin|wince|emc</span><span class='regexp_end'>/</span></span>
		<span class='id identifier rubyid_os'>os</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>windows</span><span class='tstring_end'>&#39;</span></span>
	<span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>darwin|mac os</span><span class='regexp_end'>/</span></span>
		<span class='id identifier rubyid_os'>os</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mac</span><span class='tstring_end'>&#39;</span></span>
	<span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>linux|solaris|bsd</span><span class='regexp_end'>/</span></span>
		<span class='id identifier rubyid_os'>os</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>linux</span><span class='tstring_end'>&#39;</span></span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unknown OS: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host_os'>host_os</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='id identifier rubyid_os'>os</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_db-instance_method">
  
    - (<tt>Object</tt>) <strong>load_db</strong>(filename) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='loadDB-instance_method'>loadDB</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: load_db Function: Loads a new database from a file.  DOES NOT
ALTER THE GUI. Arguments:</p>

<h1 id="label-%3E+filename+%28required%29%3A+The+FULL+PATH+to+the+saved+Datavyu+file.">&gt; filename (required): The FULL PATH to the saved Datavyu file.</h1>

<p>Returns:</p>

<h1 id="label-%3E+db%3A+The+database+of+the+opened+project.++Set+to+%24db+to+use+other">&gt; db: The database of the opened project.  Set to $db to use other</h1>

<pre class="code ruby"><code class="ruby">functions with it.</code></pre>

<h1 id="label-%3E+pj%3A+The+project+data+of+the+opened+project.++Set+to+%24pj+to+use+other">&gt; pj: The project data of the opened project.  Set to $pj to use other</h1>

<pre class="code ruby"><code class="ruby">functions with it.</code></pre>

<p>Example: $db,$pj = load_db(“/Users/username/Desktop/test.opf”)</p>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1503
1504
1505
1506
1507
1508
1509
1510
1511
1512
1513
1514
1515
1516
1517
1518
1519
1520
1521
1522
1523
1524
1525
1526
1527
1528
1529
1530
1531
1532
1533
1534
1535
1536
1537
1538
1539
1540
1541
1542
1543
1544
1545
1546
1547
1548
1549
1550
1551
1552</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1503</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_db'>load_db</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
  <span class='comment'># Packages needed for opening and saving projects and databases.
</span>

  <span class='comment'>#
</span>  <span class='comment'># ****************************************************************************
</span>  <span class='comment'># *** Check to make sure filename below is the absolute path to a project. ***
</span>  <span class='comment'># ****************************************************************************
</span>  <span class='comment'>#
</span>  <span class='comment'>#
</span>  <span class='comment'># Main body of example script:
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Opening Project: </span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Create the controller that holds all the logic for opening projects and
</span>  <span class='comment'># databases.
</span>  <span class='id identifier rubyid_open_c'>open_c</span> <span class='op'>=</span> <span class='const'>OpenC</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'>#
</span>  <span class='comment'># Opens a project and associated database (i.e. either compressed or
</span>  <span class='comment'># uncompressed .shapa files). If you want to just open a standalone database
</span>  <span class='comment'># (i.e .odb or .csv file) call open_c.open_database(&quot;filename&quot;) instead. These
</span>  <span class='comment'># methods do *NOT* open the project within the Datavyu UI.
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_proj'>proj</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_filename'>filename</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.csv</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_open_c'>open_c</span><span class='period'>.</span><span class='id identifier rubyid_open_database'>open_database</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_open_c'>open_c</span><span class='period'>.</span><span class='id identifier rubyid_open_project'>open_project</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
    <span class='comment'># Get the project that was opened (if you want).
</span>    <span class='id identifier rubyid_proj'>proj</span> <span class='op'>=</span> <span class='id identifier rubyid_open_c'>open_c</span><span class='period'>.</span><span class='id identifier rubyid_get_project'>get_project</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the database that was opened.
</span>  <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='id identifier rubyid_open_c'>open_c</span><span class='period'>.</span><span class='id identifier rubyid_get_datastore'>get_datastore</span>


  <span class='comment'># If the open went well - query the database, do calculations or whatever
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='comment'># This just prints the number of columns in the database.
</span>    <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SUCCESSFULLY Opened a project with &#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_get_all_variables'>get_all_variables</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39; columns!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to open the project &#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_filename'>filename</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_filename'>filename</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> has been loaded.</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>return</span> <span class='id identifier rubyid_db'>db</span><span class='comma'>,</span> <span class='id identifier rubyid_proj'>proj</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_macshapa_db-instance_method">
  
    - (<tt>Object</tt>) <strong>load_macshapa_db</strong>(filename, write_to_gui, *ignore_vars) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='loadMacshapaDB-instance_method'>loadMacshapaDB</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: load_macshapa_db Function: Opens an old, closed database
format MacSHAPA file and loads</p>

<pre class="code ruby"><code class="ruby">it into the current open database.

WARNING: This will only read in
matrix and string variables.  Predicates are not yet supported.
Queries will not be read in.  Times are translated to milliseconds
for compatibility with Datavyu.</code></pre>

<p>Arguments:</p>

<h1 id="label-%3E+filename+%28required%29%3A+The+FULL+PATH+to+the+saved+MacSHAPA+file.">&gt; filename (required): The FULL PATH to the saved MacSHAPA file.</h1>

<h1 id="label-%3E+write_to_gui+%28required%29%3A+Whether+the+MacSHAPA+file+should+be+read+into">&gt; write_to_gui (required): Whether the MacSHAPA file should be read into</h1>

<pre class="code ruby"><code class="ruby">the database currently open in the GUI or whether it should just be
read into the Ruby interface.  After this script is run $db and $pj
are now the MacSHAPA file.</code></pre>

<p>Returns:</p>

<h1 id="label-%3E+db%3A+The+database+of+the+opened+project.">&gt; db: The database of the opened project.</h1>

<h1 id="label-%3E+pj%3A+The+project+data+of+the+opened+project.">&gt; pj: The project data of the opened project.</h1>

<p>Example: $db,$pj = load_db(“/Users/username/Desktop/test.opf”)</p>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1646
1647
1648
1649
1650
1651
1652
1653
1654
1655
1656
1657
1658
1659
1660
1661
1662
1663
1664
1665
1666
1667
1668
1669
1670
1671
1672
1673
1674
1675
1676
1677
1678
1679
1680
1681
1682
1683
1684
1685
1686
1687
1688
1689
1690
1691
1692
1693
1694
1695
1696
1697
1698
1699
1700
1701
1702
1703
1704
1705
1706
1707
1708
1709
1710
1711
1712
1713
1714
1715
1716
1717
1718
1719
1720
1721
1722
1723
1724
1725
1726
1727
1728
1729
1730
1731
1732
1733
1734
1735
1736
1737
1738
1739
1740
1741
1742
1743
1744
1745
1746
1747
1748
1749
1750
1751
1752
1753
1754
1755
1756
1757
1758
1759
1760
1761
1762
1763
1764
1765
1766
1767
1768
1769
1770
1771
1772
1773
1774
1775
1776
1777
1778
1779
1780
1781
1782
1783
1784
1785
1786
1787
1788
1789
1790
1791
1792
1793
1794
1795
1796
1797
1798
1799
1800
1801
1802
1803
1804
1805
1806
1807
1808
1809
1810
1811
1812
1813
1814
1815
1816
1817
1818
1819
1820
1821
1822</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1646</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_macshapa_db'>load_macshapa_db</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_write_to_gui'>write_to_gui</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_ignore_vars'>ignore_vars</span><span class='rparen'>)</span>

  <span class='comment'># Create a new DB for us to use so we don&#39;t touch the GUI... some of these
</span>  <span class='comment'># files can be huge.
</span>  <span class='comment'># Since I don&#39;t know how to make a whole new project, lets just load a blank file.
</span>  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_write_to_gui'>write_to_gui</span>
    <span class='comment'>#$db,$pj = load_db(&quot;/Users/j4lingeman/Desktop/blank.opf&quot;)
</span>    <span class='comment'># $db = Datastore.new
</span>    <span class='comment'># $pj = Project.new()
</span>  <span class='kw'>end</span>


  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Opening file</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Opened file</span><span class='tstring_end'>&quot;</span></span>
  <span class='comment'># Read and split file by lines.  &#39;\r&#39; is used because that is the default
</span>  <span class='comment'># format for OS9 files.
</span>  <span class='id identifier rubyid_lines'>lines</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_lines'>lines</span> <span class='op'>+=</span> <span class='id identifier rubyid_line'>line</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_lines'>lines</span> <span class='op'>=</span> <span class='id identifier rubyid_lines'>lines</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\r\n]</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>

  <span class='comment'># Find the variable names in the file and use these to create and set up
</span>  <span class='comment'># our columns.
</span>  <span class='id identifier rubyid_predIndex'>predIndex</span> <span class='op'>=</span> <span class='id identifier rubyid_lines'>lines</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>***Predicates***</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_varIndex'>varIndex</span> <span class='op'>=</span> <span class='id identifier rubyid_lines'>lines</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>***Variables***</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spreadIndex'>spreadIndex</span> <span class='op'>=</span> <span class='id identifier rubyid_lines'>lines</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>***SpreadPane***</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_predIndex'>predIndex</span> <span class='op'>+=</span> <span class='int'>2</span>

  <span class='id identifier rubyid_variables'>variables</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_varIdent'>varIdent</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='kw'>while</span> <span class='id identifier rubyid_predIndex'>predIndex</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_varIndex'>varIndex</span>
    <span class='id identifier rubyid_l'>l</span> <span class='op'>=</span> <span class='id identifier rubyid_lines'>lines</span><span class='lbracket'>[</span><span class='id identifier rubyid_predIndex'>predIndex</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'> </span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_varname'>varname</span> <span class='op'>=</span> <span class='id identifier rubyid_l'>l</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>-</span> <span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_varname'>varname</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>###QueryVar###</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_varname'>varname</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>div</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_varname'>varname</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>qnotes</span><span class='tstring_end'>&quot;</span></span> \
			<span class='kw'>and</span> <span class='kw'>not</span> <span class='id identifier rubyid_ignore_vars'>ignore_vars</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_varname'>varname</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_varname'>varname</span>

      <span class='comment'># Replace non-alphabet with underscores
</span>      <span class='id identifier rubyid_vname2'>vname2</span> <span class='op'>=</span> <span class='id identifier rubyid_varname'>varname</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\W+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_vname2'>vname2</span> <span class='op'>!=</span> <span class='id identifier rubyid_varname'>varname</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Replacing </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_varname'>varname</span><span class='embexpr_end'>}</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_vname2'>vname2</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_varname'>varname</span> <span class='op'>=</span> <span class='id identifier rubyid_vname2'>vname2</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_variables'>variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_varname'>varname</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_l'>l</span><span class='lbracket'>[</span><span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='op'>+</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_varIdent'>varIdent</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_l'>l</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_predIndex'>predIndex</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Got predicate index</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Create the columns for the variables
</span>  <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='comment'># Create column
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_getColumnList'>getColumnList</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_deleteVariable'>deleteVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>end</span>


    <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='comment'># Strip out the ordinal, onset, and offset.  These will be handled on a
</span>      <span class='comment'># cell by cell basis.
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;ord&gt;</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;onset&gt;</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;offset&gt;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_args'>args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_setVariable'>setVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_createVariable'>createVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Search for where in the file the var&#39;s cells are, create them, then move
</span>  <span class='comment'># on to the next variable.
</span>  <span class='id identifier rubyid_varSection'>varSection</span> <span class='op'>=</span> <span class='id identifier rubyid_lines'>lines</span><span class='lbracket'>[</span><span class='id identifier rubyid_varIndex'>varIndex</span><span class='op'>..</span><span class='id identifier rubyid_spreadIndex'>spreadIndex</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_varIdent'>varIdent</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>

    <span class='comment'># Search the variable section for the above id
</span>    <span class='id identifier rubyid_varSection'>varSection</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span>
      <span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\t\s]</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_id'>id</span>

        <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_id'>id</span>
        <span class='id identifier rubyid_varname'>varname</span> <span class='op'>=</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_slice'>slice</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\W+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_getVariableList'>getVariableList</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_varname'>varname</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_col'>col</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='rparen'>)</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Column </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_varname'>varname</span><span class='embexpr_end'>}</span><span class='tstring_content'> not found. Skipping.</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>next</span>
        <span class='kw'>end</span>

        <span class='comment'>#print_debug varname
</span>        <span class='id identifier rubyid_start'>start</span> <span class='op'>=</span> <span class='id identifier rubyid_varSection'>varSection</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_l'>l</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span>

        <span class='id identifier rubyid_stringCol'>stringCol</span> <span class='op'>=</span> <span class='kw'>false</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_varSection'>varSection</span><span class='lbracket'>[</span><span class='id identifier rubyid_start'>start</span> <span class='op'>-</span> <span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>strID</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='kw'>nil</span>
          <span class='id identifier rubyid_stringCol'>stringCol</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>end</span>

        <span class='comment'>#Found it!  Now build the cells
</span>        <span class='kw'>while</span> <span class='id identifier rubyid_varSection'>varSection</span><span class='lbracket'>[</span><span class='id identifier rubyid_start'>start</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span>

          <span class='kw'>if</span> <span class='id identifier rubyid_stringCol'>stringCol</span> <span class='op'>==</span> <span class='kw'>false</span>
            <span class='id identifier rubyid_cellData'>cellData</span> <span class='op'>=</span> <span class='id identifier rubyid_varSection'>varSection</span><span class='lbracket'>[</span><span class='id identifier rubyid_start'>start</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\t]</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_cellData'>cellData</span><span class='lbracket'>[</span><span class='id identifier rubyid_cellData'>cellData</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cellData'>cellData</span><span class='lbracket'>[</span><span class='id identifier rubyid_cellData'>cellData</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_cellData'>cellData</span><span class='lbracket'>[</span><span class='id identifier rubyid_cellData'>cellData</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='op'>..</span><span class='id identifier rubyid_cellData'>cellData</span><span class='lbracket'>[</span><span class='id identifier rubyid_cellData'>cellData</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='id identifier rubyid_cellData'>cellData</span> <span class='op'>=</span> <span class='id identifier rubyid_varSection'>varSection</span><span class='lbracket'>[</span><span class='id identifier rubyid_start'>start</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\t]</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
          <span class='kw'>end</span>

          <span class='comment'># Init cell to null
</span>
          <span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_create_cell'>create_cell</span>

          <span class='comment'># Convert onset/offset from 60 ticks/sec to milliseconds
</span>          <span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cellData'>cellData</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>/</span> <span class='float'>60.0</span> <span class='op'>*</span> <span class='int'>1000</span>
          <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cellData'>cellData</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>/</span> <span class='float'>60.0</span> <span class='op'>*</span> <span class='int'>1000</span>

          <span class='comment'># Set onset/offset of cell
</span>          <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_onset'>onset</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='rparen'>)</span>

          <span class='comment'># Split up cell data
</span>          <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_cellData'>cellData</span><span class='lbracket'>[</span><span class='id identifier rubyid_cellData'>cellData</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='int'>1</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_data'>data</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_stringCol'>stringCol</span> <span class='op'>==</span> <span class='kw'>false</span>
            <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span>
            <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[() ]*</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
          <span class='kw'>elsif</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='comment'>#Then this is a string var
</span>            <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='lparen'>(</span><span class='rparen'>)</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>1</span>
              <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='op'>..</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span> <span class='comment'># Remove the char count
</span>              <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> or </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
              <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[^\w ]*</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
              <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>  </span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='kw'>else</span>
              <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>end</span>
          <span class='kw'>else</span>
            <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
            <span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='kw'>nil</span>
          <span class='kw'>end</span>
          <span class='comment'># Cycle thru cell data arguments and fill them into the cell matrix
</span>          <span class='id identifier rubyid_narg'>narg</span> <span class='op'>=</span> <span class='int'>0</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_argname'>argname</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
            <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_argname'>argname</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
          <span class='kw'>elsif</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
              <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
              <span class='id identifier rubyid_argname'>argname</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
              <span class='kw'>if</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>==</span> <span class='kw'>nil</span>
                <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_argname'>argname</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
              <span class='kw'>elsif</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>or</span> <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='kw'>nil</span>
                <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_argname'>argname</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
              <span class='kw'>else</span>
                <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_argname'>argname</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span><span class='rparen'>)</span>
              <span class='kw'>end</span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
          <span class='id identifier rubyid_start'>start</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_setVariable'>setVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_col'>col</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span><span class='lparen'>(</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$pj</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="make_reliability-instance_method">
  
    - (<tt>Object</tt>) <strong>make_reliability</strong>(relname, var_to_copy, multiple_to_keep, *args_to_keep) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='makeReliability-instance_method'>makeReliability</span>, <span id='make_rel-instance_method'>make_rel</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: make_rel Function: This function will create a reliability
column that is a copy</p>

<pre class="code ruby"><code class="ruby">of another column in the database, copying every nth cell and
carrying over some of the arguments from the original, if wanted.</code></pre>

<p>Arguments:</p>

<h1 id="label-%3E+relname+%28required%29%3A+The+name+of+the+reliability+column+to+be+created.">&gt; relname (required): The name of the reliability column to be created.</h1>

<h1 id="label-%3E+var_to_copy+%28required%29%3A+The+name+of+the+variable+in+the+database+you">&gt; var_to_copy (required): The name of the variable in the database you</h1>

<pre class="code ruby"><code class="ruby">wish to copy.</code></pre>

<h1 id="label-%3E+multiple_to_keep%3A+The+number+of+cells+to+skip.++For+every+other+cell%2C+use+2.">&gt; multiple_to_keep: The number of cells to skip.  For every other cell, use 2.</h1>

<h1 id="label-%3E+%2Aargs_to_keep%3A+Comma+separated+strings+for+the+arguments+you+want+to+keep">&gt; *args_to_keep: Comma separated strings for the arguments you want to keep</h1>

<pre class="code ruby"><code class="ruby">between cells.  For example, &quot;onset&quot;, &quot;trialnum&quot;, &quot;block&quot; would keep
those three arguments in the new cells that are created.</code></pre>

<p>Returns:</p>

<h1 id="label-%3E+A+Ruby+object+representation+of+the+rel+column+inside+Datavyu.">&gt; A Ruby object representation of the rel column inside Datavyu.</h1>

<p>Usage:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rel_trial'>rel_trial</span> <span class='op'>=</span> <span class='id identifier rubyid_make_rel'>make_rel</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rel.trial</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trial</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trialnum</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unit</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 959</span>

<span class='kw'>def</span> <span class='id identifier rubyid_make_reliability'>make_reliability</span><span class='lparen'>(</span><span class='id identifier rubyid_relname'>relname</span><span class='comma'>,</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='comma'>,</span> <span class='id identifier rubyid_multiple_to_keep'>multiple_to_keep</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args_to_keep'>args_to_keep</span><span class='rparen'>)</span>
  <span class='comment'># Get the primary variable from the DB
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>String</span>
    <span class='id identifier rubyid_var_to_copy'>var_to_copy</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_var_to_copy'>var_to_copy</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_args_to_keep'>args_to_keep</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>Array</span>
    <span class='id identifier rubyid_args_to_keep'>args_to_keep</span> <span class='op'>=</span> <span class='id identifier rubyid_args_to_keep'>args_to_keep</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Clip down cells to fit multiple to keep
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_multiple_to_keep'>multiple_to_keep</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>%</span> <span class='id identifier rubyid_multiple_to_keep'>multiple_to_keep</span> <span class='op'>!=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>/</span> <span class='id identifier rubyid_multiple_to_keep'>multiple_to_keep</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='comment'># Clear out the nil cells
</span>  <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_compact!'>compact!</span>

  <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_args_to_keep'>args_to_keep</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_args_to_keep'>args_to_keep</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_args_to_keep'>args_to_keep</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_setVariable'>setVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_relname'>relname</span><span class='comma'>,</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="makeDurationBlockRel-instance_method">
  
    - (<tt>Object</tt>) <strong>makeDurationBlockRel</strong>(relname, var_to_copy, binding, block_dur, skip_blocks) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: makeDurationBlockRel Function: Makes a duration based
reliability column based on John&#39;s method.  It will create two new
columns, one that contains a cell with a number for that block, and another
blank column for the free coding within that block. Arguments:</p>

<h1 id="label-%3E+relname+%28required%29%3A+The+name+of+the+rel+column+to+be+made.">&gt; relname (required): The name of the rel column to be made.</h1>

<h1 id="label-%3E+var_to_copy+%28required%29%3A+The+name+of+the+variable+being+copied.">&gt; var_to_copy (required): The name of the variable being copied.</h1>

<h1 id="label-%3E+binding+%28required%29%3A+The+name+of+the+variable+to+bind+the+copy+to.">&gt; binding (required): The name of the variable to bind the copy to.</h1>

<h1 id="label-%3E+block_dur+%28required%29%3A+How+long+%28in+seconds%29+should+the+blocks+be%3F">&gt; block_dur (required): How long (in seconds) should the blocks be?</h1>

<h1 id="label-%3E+skip_blocks+%28required%29%3A+How+many+blocks+of+block_dur+should+we+skip+between">&gt; skip_blocks (required): How many blocks of block_dur should we skip between</h1>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_each'>each</span> <span class='id identifier rubyid_coding'>coding</span> <span class='id identifier rubyid_block?'>block?</span></code></pre>

<p># Returns:</p>

<h1 id="label-%3E+Nothing.++Variables+are+written+to+the+database.">&gt; Nothing.  Variables are written to the database.</h1>

<p>#——————————————————————-</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1079</span>

<span class='kw'>def</span> <span class='id identifier rubyid_makeDurationBlockRel'>makeDurationBlockRel</span><span class='lparen'>(</span><span class='id identifier rubyid_relname'>relname</span><span class='comma'>,</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='comma'>,</span> <span class='id identifier rubyid_binding'>binding</span><span class='comma'>,</span> <span class='id identifier rubyid_block_dur'>block_dur</span><span class='comma'>,</span> <span class='id identifier rubyid_skip_blocks'>skip_blocks</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_block_var'>block_var</span> <span class='op'>=</span> <span class='id identifier rubyid_createVariable'>createVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_relname'>relname</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_blocks</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>block_num</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_rel_var'>rel_var</span> <span class='op'>=</span> <span class='id identifier rubyid_make_rel'>make_rel</span><span class='lparen'>(</span><span class='id identifier rubyid_relname'>relname</span><span class='comma'>,</span> <span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_var_to_copy'>var_to_copy</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_var_to_copy'>var_to_copy</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_binding'>binding</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_binding'>binding</span><span class='rparen'>)</span>


  <span class='id identifier rubyid_block_dur'>block_dur</span> <span class='op'>=</span> <span class='id identifier rubyid_block_dur'>block_dur</span> <span class='op'>*</span> <span class='int'>1000</span> <span class='comment'># Convert to milliseconds
</span>  <span class='id identifier rubyid_block_num'>block_num</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_bindcell'>bindcell</span> <span class='kw'>in</span> <span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='id identifier rubyid_cell_dur'>cell_dur</span> <span class='op'>=</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>-</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cell_dur'>cell_dur</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_block_dur'>block_dur</span>
      <span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='id identifier rubyid_block_var'>block_var</span><span class='period'>.</span><span class='id identifier rubyid_make_new_cell'>make_new_cell</span><span class='lparen'>(</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>block_num</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_block_num'>block_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_block_num'>block_num</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_num_possible_blocks'>num_possible_blocks</span> <span class='op'>=</span> <span class='id identifier rubyid_cell_dur'>cell_dur</span> <span class='op'>/</span> <span class='id identifier rubyid_block_dur'>block_dur</span> <span class='comment'>#Integer division
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_num_possible_blocks'>num_possible_blocks</span> <span class='op'>&gt;</span> <span class='int'>0</span>
        <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_num_possible_blocks'>num_possible_blocks</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>%</span> <span class='id identifier rubyid_skip_blocks'>skip_blocks</span> <span class='op'>==</span> <span class='int'>0</span>
            <span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='id identifier rubyid_block_var'>block_var</span><span class='period'>.</span><span class='id identifier rubyid_make_new_cell'>make_new_cell</span><span class='lparen'>(</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>block_num</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_block_num'>block_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='id identifier rubyid_block_dur'>block_dur</span><span class='rparen'>)</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_block_dur'>block_dur</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
              <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_block_dur'>block_dur</span><span class='rparen'>)</span>
            <span class='kw'>else</span>
              <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bindcell'>bindcell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
            <span class='kw'>end</span>
            <span class='id identifier rubyid_block_num'>block_num</span> <span class='op'>+=</span> <span class='int'>1</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_setVariable'>setVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_relname'>relname</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_blocks</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_block_var'>block_var</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_cell_codes-instance_method">
  
    - (<tt>Object</tt>) <strong>print_cell_codes</strong>(cell) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='printCellCodes-instance_method'>printCellCodes</span>, <span id='printCellArgs-instance_method'>printCellArgs</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Prints ordinal, onset, offset, and the values of all codes from the given
cell.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2331
2332
2333
2334
2335
2336
2337
2338
2339
2340</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2331</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_cell_codes'>print_cell_codes</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_s'>s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_codes-instance_method">
  
    - (<tt>Object</tt>) <strong>print_codes</strong>(cell, file, args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='print_args-instance_method'>print_args</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Outputs the values of all codes specified from the given cell to the given
output file. Row is delimited by tabs.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2309
2310
2311
2312
2313
2314
2315</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2309</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_codes'>print_codes</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='comma'>,</span> <span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_a'>a</span> <span class='kw'>in</span> <span class='id identifier rubyid_args'>args</span>
    <span class='comment'>#puts &quot;Printing: &quot; + a
</span>    <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_debug-instance_method">
  
    - (<tt>Object</tt>) <strong>print_debug</strong>(*s) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 99</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='gvar'>$debug</span> <span class='op'>==</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_err-instance_method">
  
    - (<tt>Object</tt>) <strong>print_err</strong>(m_cell, r_cell, arg, dump_file, main_col, rel_col) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define interal function for printing errors</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2040
2041
2042
2043
2044
2045
2046
2047
2048</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2040</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_err'>print_err</span><span class='lparen'>(</span><span class='id identifier rubyid_m_cell'>m_cell</span><span class='comma'>,</span> <span class='id identifier rubyid_r_cell'>r_cell</span><span class='comma'>,</span> <span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_dump_file'>dump_file</span><span class='comma'>,</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='comma'>,</span> <span class='id identifier rubyid_rel_col'>rel_col</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_main_val'>main_val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m_cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_rel_val'>rel_val</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>r_cell.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_err_str'>err_str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ERROR in </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_main_col'>main_col</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> at Ordinal </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_m_cell'>m_cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, rel ordinal </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_r_cell'>r_cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> in argument </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_arg'>arg</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_main_val'>main_val</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_rel_val'>rel_val</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_dump_file'>dump_file</span> <span class='op'>!=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_dump_file'>dump_file</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_err_str'>err_str</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_print'>print</span> <span class='id identifier rubyid_err_str'>err_str</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_no_column_found_warning-instance_method">
  
    - (<tt>Object</tt>) <strong>print_no_column_found_warning</strong>(colName) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='printNoColumnFoundWarning-instance_method'>printNoColumnFoundWarning</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Let the user know that a given column was not found. Error is confusing,
this should clarify.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1618
1619
1620</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1618</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_no_column_found_warning'>print_no_column_found_warning</span><span class='lparen'>(</span><span class='id identifier rubyid_colName'>colName</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>WARNING: No column with name &#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_colName'>colName</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39; was found!</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="save_db-instance_method">
  
    - (<tt>Object</tt>) <strong>save_db</strong>(filename) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='saveDB-instance_method'>saveDB</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: save_db Function: Saves the current $db and $pj variables to
filename.  If</p>

<pre class="code ruby"><code class="ruby">filename ends with .csv, it saves a .csv file.  Otherwise it saves
it as a .opf.</code></pre>

<p>Arguments:</p>

<h1 id="label-%3E+filename+%28required%29%3A+The+FULL+PATH+to+where+the+Datavyu+file+should">&gt; filename (required): The FULL PATH to where the Datavyu file should</h1>

<pre class="code ruby"><code class="ruby">be saved.</code></pre>

<p>Returns:</p>

<h1 id="label-%3E+Nothing.">&gt; Nothing.</h1>

<p>Example: save_db(“/Users/username/Desktop/test.opf”)</p>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1570
1571
1572
1573
1574
1575
1576
1577
1578
1579
1580
1581
1582
1583
1584
1585
1586
1587
1588
1589
1590
1591
1592
1593
1594
1595
1596
1597
1598
1599</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1570</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save_db'>save_db</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
  <span class='comment'>#
</span>  <span class='comment'># Main body of example script:
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Saving Database: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_filename'>filename</span>

  <span class='comment'># Create the controller that holds all the logic for opening projects and
</span>  <span class='comment'># databases.
</span>  <span class='id identifier rubyid_save_c'>save_c</span> <span class='op'>=</span> <span class='const'>SaveC</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'>#
</span>  <span class='comment'># Saves a database (i.e. a .odb or .csv file). If you want to save a project
</span>  <span class='comment'># call save_project(&quot;project file&quot;, project, database) instead.
</span>  <span class='comment'># These methods do *NOT* alter the Datavyu UI.
</span>  <span class='comment'>#
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_filename'>filename</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.csv</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_save_c'>save_c</span><span class='period'>.</span><span class='id identifier rubyid_save_database'>save_database</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='gvar'>$db</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='comment'>#if $pj == nil or $pj.getDatabaseFileName == nil
</span>    <span class='gvar'>$pj</span> <span class='op'>=</span> <span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='gvar'>$pj</span><span class='period'>.</span><span class='id identifier rubyid_setDatabaseFileName'>setDatabaseFileName</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>db</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_dbname'>dbname</span> <span class='op'>=</span> <span class='id identifier rubyid_filename'>filename</span><span class='lbracket'>[</span><span class='id identifier rubyid_filename'>filename</span><span class='period'>.</span><span class='id identifier rubyid_rindex'>rindex</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='op'>+</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_filename'>filename</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span>
    <span class='gvar'>$pj</span><span class='period'>.</span><span class='id identifier rubyid_setProjectName'>setProjectName</span><span class='lparen'>(</span><span class='id identifier rubyid_dbname'>dbname</span><span class='rparen'>)</span>
    <span class='comment'>#end
</span>    <span class='id identifier rubyid_save_file'>save_file</span> <span class='op'>=</span> <span class='id identifier rubyid_java'>java</span><span class='period'>.</span><span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_save_c'>save_c</span><span class='period'>.</span><span class='id identifier rubyid_save_project'>save_project</span><span class='lparen'>(</span><span class='id identifier rubyid_save_file'>save_file</span><span class='comma'>,</span> <span class='gvar'>$pj</span><span class='comma'>,</span> <span class='gvar'>$db</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_print_debug'>print_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Save successful.</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="scan_for_bad_cells-instance_method">
  
    - (<tt>Object</tt>) <strong>scan_for_bad_cells</strong>(col) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1167</span>

<span class='kw'>def</span> <span class='id identifier rubyid_scan_for_bad_cells'>scan_for_bad_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_col'>col</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_error'>error</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ERROR AT CELL </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> IN COLUMN </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, the onset is &gt; than the offset.</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_error'>error</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_error'>error</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Please fix these errors, as the script cannot continue until then.</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_exit'>exit</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_column-instance_method">
  
    - (<tt>Object</tt>) <strong>set_column</strong>(*args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='setVariable-instance_method'>setVariable</span>, <span id='setColumn-instance_method'>setColumn</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: setVariable Function: setVariable will overwrite a variable in
the database with the same name as the name argument.</p>

<pre class="code ruby"><code class="ruby">If no variable with the same name exists, it will create a new variable.</code></pre>

<p>Arguments:</p>

<h1 id="label-%3E+name+%28optional%29%3A+The+name+of+the+variable+being+created">&gt; name (optional): The name of the variable being created</h1>

<h1 id="label-%3E+var++%28required%29%3A+The+Ruby+container+of+the+variable+to+be+put+into+the+database.++This+is+the+return+value+of">&gt; var  (required): The Ruby container of the variable to be put into the database.  This is the return value of</h1>

<pre class="code ruby"><code class="ruby">createNewVariable or getVariable that has been modified.</code></pre>

<p>Usage:</p>

<pre class="code ruby"><code class="ruby">trial = getVariable(&quot;trial&quot;)
** Do some modification to trial
setVariable(&quot;trial&quot;, trial)</code></pre>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 721</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_column'>set_column</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>2</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># If substantial changes have been made to the structure of the column,
</span>  <span class='comment'># just delete the whole thing first.
</span>  <span class='comment'># If the column was dirty, redo the vocab too
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span> <span class='op'>==</span> <span class='kw'>nil</span> <span class='kw'>or</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_get_name'>get_name</span> <span class='op'>!=</span> <span class='id identifier rubyid_name'>name</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_getColumnList'>getColumnList</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_deleteVariable'>deleteVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='comment'># Create a new variable
</span>    <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='period'>.</span><span class='id identifier rubyid_createVariable'>createVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_removeArgument'>removeArgument</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code01</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Set variable&#39;s vocab
</span>    <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
      <span class='id identifier rubyid_new_arg'>new_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_addArgument'>addArgument</span><span class='lparen'>(</span><span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>NOMINAL</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_new_arg'>new_arg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span>
      <span class='id identifier rubyid_main_arg'>main_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='lparen'>(</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_child_args'>child_args</span> <span class='op'>=</span> <span class='id identifier rubyid_main_arg'>main_arg</span><span class='period'>.</span><span class='id identifier rubyid_childArguments'>childArguments</span>

      <span class='id identifier rubyid_child_args'>child_args</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_child_args'>child_args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span>

      <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_setRootNode'>setRootNode</span><span class='lparen'>(</span><span class='id identifier rubyid_main_arg'>main_arg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>
  <span class='kw'>end</span>

  <span class='comment'>#p var
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_dirty'>dirty</span>
    <span class='comment'># deleteVariable(name)
</span>    <span class='comment'># If the variable is dirty, then we have to do something to the vocab.
</span>    <span class='comment'># Compare the variable&#39;s vocab and the Ruby cell version to see
</span>    <span class='comment'># what is different.
</span>
    <span class='comment'>#p var.db_var
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
      <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_childArguments'>childArguments</span>
      <span class='comment'>#p values
</span>      <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_old_args'>old_args</span>
        <span class='comment'>#p var.old_args
</span>        <span class='id identifier rubyid_flag'>flag</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='kw'>for</span> <span class='id identifier rubyid_dbarg'>dbarg</span> <span class='kw'>in</span> <span class='id identifier rubyid_values'>values</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span> <span class='op'>==</span> <span class='id identifier rubyid_dbarg'>dbarg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
            <span class='id identifier rubyid_flag'>flag</span> <span class='op'>=</span> <span class='kw'>true</span>
            <span class='kw'>break</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        <span class='comment'># If we didn&#39;t find it in dbarg, we have to create it
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_flag'>flag</span> <span class='op'>==</span> <span class='kw'>false</span>
          <span class='comment'># Add the argument
</span>          <span class='id identifier rubyid_new_arg'>new_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_addArgument'>addArgument</span><span class='lparen'>(</span><span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>NOMINAL</span><span class='rparen'>)</span>

          <span class='comment'># Make sure argument doesn&#39;t have &lt; or &gt; in it.
</span>          <span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='comment'># Change the argument&#39;s name by getting the variable back,
</span>          <span class='comment'># and then setting it. This hoop jumping is annoying.
</span>          <span class='id identifier rubyid_new_arg'>new_arg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span>
          <span class='id identifier rubyid_main_arg'>main_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='lparen'>(</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_child_args'>child_args</span> <span class='op'>=</span> <span class='id identifier rubyid_main_arg'>main_arg</span><span class='period'>.</span><span class='id identifier rubyid_childArguments'>childArguments</span>

          <span class='id identifier rubyid_child_args'>child_args</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_child_args'>child_args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span>

          <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_setVariableType'>setVariableType</span><span class='lparen'>(</span><span class='id identifier rubyid_main_arg'>main_arg</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='comment'># Now see if we have deleted any arguments
</span>      <span class='id identifier rubyid_deleted_args'>deleted_args</span> <span class='op'>=</span> <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span> <span class='op'>-</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_old_args'>old_args</span>
      <span class='id identifier rubyid_deleted_args'>deleted_args</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DELETING ARG: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_removeArgument'>removeArgument</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>


  <span class='kw'>end</span>

  <span class='comment'># Create new cells and fill them in for each cell in the variable
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='comment'># Copy the information from the ruby variable to the new cell
</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>==</span> <span class='kw'>nil</span> <span class='kw'>or</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>!=</span> <span class='id identifier rubyid_name'>name</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_createCell'>createCell</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getValue'>getValue</span><span class='lparen'>(</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>!=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_setOnset'>setOnset</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>!=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_setOffset'>setOffset</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Matrix cell
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
      <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getValue'>getValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span><span class='lparen'>(</span><span class='rparen'>)</span>
      <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_old_args'>old_args</span>
        <span class='comment'># Find the arg in the db&#39;s arglist that we are looking for
</span>        <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
          <span class='id identifier rubyid_dbarg'>dbarg</span> <span class='op'>=</span> <span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_dbarg_name'>dbarg_name</span> <span class='op'>=</span> <span class='id identifier rubyid_dbarg'>dbarg</span><span class='period'>.</span><span class='id identifier rubyid_getArgument'>getArgument</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_dbarg_name'>dbarg_name</span> <span class='op'>==</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_dbarg'>dbarg</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
            <span class='kw'>break</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='comment'># Non-matrix cell
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getValue'>getValue</span><span class='lparen'>(</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>var</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Save the changes back to the DB
</span>
  <span class='kw'>end</span>
  <span class='comment'># if var.hidden
</span>  <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_setHidden'>setHidden</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span><span class='rparen'>)</span>
  <span class='comment'># end
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_column!-instance_method">
  
    - (<tt>Object</tt>) <strong>set_column!</strong>(*args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='setVariable!-instance_method'>setVariable!</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Deletes a variable from the spreadsheet and rebuilds it from the given
RVariable object. Behaves similar to setVariable(), but this will ALWAYS
delete and rebuild the spreadsheet colum and its vocab.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 865</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_column!'>set_column!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>2</span>
    <span class='id identifier rubyid_var'>var</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_getColumnList'>getColumnList</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_deleteVariable'>deleteVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new variable
</span>  <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='period'>.</span><span class='id identifier rubyid_createVariable'>createVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_removeArgument'>removeArgument</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code01</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Set variable&#39;s vocab
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>
    <span class='id identifier rubyid_new_arg'>new_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_addArgument'>addArgument</span><span class='lparen'>(</span><span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>NOMINAL</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_new_arg'>new_arg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span>
    <span class='id identifier rubyid_main_arg'>main_arg</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_child_args'>child_args</span> <span class='op'>=</span> <span class='id identifier rubyid_main_arg'>main_arg</span><span class='period'>.</span><span class='id identifier rubyid_childArguments'>childArguments</span>

    <span class='id identifier rubyid_child_args'>child_args</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_child_args'>child_args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span>

    <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_setRootNode'>setRootNode</span><span class='lparen'>(</span><span class='id identifier rubyid_main_arg'>main_arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>

  <span class='comment'># Create new cells and fill them in for each cell in the variable
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
    <span class='comment'># Copy the information from the ruby variable to the new cell
</span>    <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_createCell'>createCell</span><span class='lparen'>(</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getValue'>getValue</span><span class='lparen'>(</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>!=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_setOnset'>setOnset</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>!=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_setOffset'>setOffset</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Matrix cell
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
      <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getValue'>getValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span><span class='lparen'>(</span><span class='rparen'>)</span>
      <span class='kw'>for</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>in</span> <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_old_args'>old_args</span>
        <span class='comment'># Find the arg in the db&#39;s arglist that we are looking for
</span>        <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
          <span class='id identifier rubyid_dbarg'>dbarg</span> <span class='op'>=</span> <span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_dbarg_name'>dbarg_name</span> <span class='op'>=</span> <span class='id identifier rubyid_dbarg'>dbarg</span><span class='period'>.</span><span class='id identifier rubyid_getArgument'>getArgument</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_dbarg_name'>dbarg_name</span> <span class='op'>==</span> <span class='id identifier rubyid_arg'>arg</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_dbarg'>dbarg</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
            <span class='kw'>break</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='comment'># Non-matrix cell
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span><span class='period'>.</span><span class='id identifier rubyid_getValue'>getValue</span><span class='lparen'>(</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>var</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># if var.hidden
</span>  <span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_db_var'>db_var</span><span class='period'>.</span><span class='id identifier rubyid_setHidden'>setHidden</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span><span class='rparen'>)</span>
  <span class='comment'># end
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smooth_column-instance_method">
  
    - (<tt>Object</tt>) <strong>smooth_column</strong>(colname, tol = 33) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='smoothColumn-instance_method'>smoothColumn</span></span>
    </span>
  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2293
2294
2295
2296
2297
2298
2299
2300
2301
2302
2303
2304</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 2293</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smooth_column'>smooth_column</span><span class='lparen'>(</span><span class='id identifier rubyid_colname'>colname</span><span class='comma'>,</span> <span class='id identifier rubyid_tol'>tol</span><span class='op'>=</span><span class='int'>33</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_col'>col</span> <span class='op'>=</span> <span class='id identifier rubyid_getVariable'>getVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_colname'>colname</span><span class='rparen'>)</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>2</span>
    <span class='id identifier rubyid_curcell'>curcell</span> <span class='op'>=</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_nextcell'>nextcell</span> <span class='op'>=</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_nextcell'>nextcell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>-</span> <span class='id identifier rubyid_curcell'>curcell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_tol'>tol</span>
      <span class='id identifier rubyid_nextcell'>nextcell</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>onset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_curcell'>curcell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_setVariable'>setVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_colname'>colname</span><span class='comma'>,</span> <span class='id identifier rubyid_col'>col</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="transfer_columns-instance_method">
  
    - (<tt>Object</tt>) <strong>transfer_columns</strong>(db1, db2, remove, *varnames) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='transfer_column-instance_method'>transfer_column</span>, <span id='transferColumns-instance_method'>transferColumns</span>, <span id='transferColumn-instance_method'>transferColumn</span>, <span id='transferVariables-instance_method'>transferVariables</span>, <span id='transferVariable-instance_method'>transferVariable</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <hr style="height: 10px">

<p>Method name: transfer_columns Function: Transfers columns between
databases.  If db1 or db2 are set</p>

<pre class="code ruby"><code class="ruby">to the empty string &quot;&quot;, then that database is the current database
in $db (usually the GUI&#39;s database).  So if you want to transfer a
column into the GUI, set db2 to &quot;&quot;.  If you want to tranfer a column
from the GUI into a file, set db1 to &quot;&quot;.  Setting remove to true will
DELETE THE COLUMNS YOU ARE TRANSFERRING FROM DB1.  Be careful!</code></pre>

<p>Arguments:</p>

<h1 id="label-%3E+db1+%28required%29%3A+The+FULL+PATH+to+the+saved+Datavyu+file+or+set+to">&gt; db1 (required): The FULL PATH to the saved Datavyu file or set to</h1>

<pre class="code ruby"><code class="ruby">&quot;&quot; to use the currently opened database. Columns are transferred FROM here.</code></pre>

<h1 id="label-%3E+db2+%28required%29%3A+The+FULL+PATH+to+the+saved+Datavyu+file+or+set+to">&gt; db2 (required): The FULL PATH to the saved Datavyu file or set to</h1>

<pre class="code ruby"><code class="ruby">&quot;&quot; to use the currently opened database.  Columns are tranferred TO here.</code></pre>

<h1 id="label-%3E+remove+%28required%29%3A+Set+to+true+to+delete+columns+in+DB1+as+they+are+moved+to">&gt; remove (required): Set to true to delete columns in DB1 as they are moved to</h1>

<pre class="code ruby"><code class="ruby">db2.  Set to false to leave them intact.</code></pre>

<h1 id="label-%3E+varnames+%28requires+at+least+1%29%3A+You+can+specify+as+many+var+names+as+you+like">&gt; varnames (requires at least 1): You can specify as many var names as you like</h1>

<pre class="code ruby"><code class="ruby">that will be retrieved from db1.  These should be the string names of the
variables.</code></pre>

<p>Returns:</p>

<h1 id="label-%3E+Nothing.++Saves+the+files+in+place+or+modifies+the+GUI">&gt; Nothing.  Saves the files in place or modifies the GUI</h1>

<p>Example:</p>

<pre class="code ruby"><code class="ruby">transfer_columns(&quot;/Users/username/Desktop/test.opf&quot;,&quot;&quot;,true,&quot;idchange&quot;)
The above example will transfer the column &quot;idchange&quot; from test.opf to the GUI
and leave test.opf intact with no modifications.</code></pre>
<hr style="height: 10px">


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1852
1853
1854
1855
1856
1857
1858
1859
1860
1861
1862
1863
1864
1865
1866
1867
1868
1869
1870
1871
1872
1873
1874
1875
1876
1877
1878
1879
1880
1881
1882
1883
1884
1885
1886
1887
1888
1889
1890
1891
1892
1893
1894
1895
1896
1897
1898
1899
1900
1901
1902
1903
1904
1905
1906
1907
1908
1909
1910
1911
1912
1913
1914
1915
1916
1917
1918
1919
1920
1921
1922
1923
1924
1925
1926
1927
1928
1929
1930
1931
1932
1933
1934
1935
1936
1937
1938
1939
1940
1941
1942
1943
1944
1945
1946
1947
1948
1949
1950
1951
1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'Datavyu_API.rb', line 1852</span>

<span class='kw'>def</span> <span class='id identifier rubyid_transfer_columns'>transfer_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_db1'>db1</span><span class='comma'>,</span> <span class='id identifier rubyid_db2'>db2</span><span class='comma'>,</span> <span class='id identifier rubyid_remove'>remove</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_varnames'>varnames</span><span class='rparen'>)</span>
  <span class='comment'># Save the current $db and $proj global variables
</span>  <span class='id identifier rubyid_saved_db'>saved_db</span><span class='comma'>,</span> <span class='id identifier rubyid_saved_proj'>saved_proj</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$proj</span>

  <span class='comment'># If varnames was specified as a hash, flatten it to an array
</span>  <span class='id identifier rubyid_varnames'>varnames</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>

  <span class='comment'># Display args when debugging
</span>  <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='op'>*</span><span class='int'>20</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_content'> called with following args:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='id identifier rubyid_db1'>db1</span><span class='comma'>,</span> <span class='id identifier rubyid_db2'>db2</span><span class='comma'>,</span> <span class='id identifier rubyid_remove'>remove</span><span class='comma'>,</span> <span class='id identifier rubyid_varnames'>varnames</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='op'>*</span><span class='int'>20</span><span class='rparen'>)</span>

  <span class='comment'># Handle degenerate case of same source and destination
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_db1'>db1</span><span class='op'>==</span><span class='id identifier rubyid_db2'>db2</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Warning: source and destination are identical.  No changes made.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># Set the source database, loading from file if necessary.
</span>  <span class='comment'># Raises file not found error and returns nil if source database does not exist.
</span>  <span class='id identifier rubyid_db1path'>db1path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_db1'>db1</span><span class='op'>!=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_db1path'>db1path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_db1'>db1</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_readable?'>readable?</span><span class='lparen'>(</span><span class='id identifier rubyid_db1path'>db1path</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error! File not readable : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_db1'>db1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Loading source database from file : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_db1path'>db1path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_from_db'>from_db</span><span class='comma'>,</span> <span class='id identifier rubyid_from_proj'>from_proj</span> <span class='op'>=</span> <span class='id identifier rubyid_loadDB'>loadDB</span><span class='lparen'>(</span><span class='id identifier rubyid_db1path'>db1path</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_from_db'>from_db</span><span class='comma'>,</span> <span class='id identifier rubyid_from_proj'>from_proj</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$proj</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># Set the destination database, loading from file if necessary.
</span>  <span class='comment'># Raises file not found error and returns nil if destination database does not exist.
</span>  <span class='id identifier rubyid_db2path'>db2path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_db2'>db2</span><span class='op'>!=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_db2path'>db2path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_db2'>db2</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_writable?'>writable?</span><span class='lparen'>(</span><span class='id identifier rubyid_db2path'>db2path</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error! File not writable : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_db2'>db2</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Loading destination database from file : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_db2path'>db2path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_to_db'>to_db</span><span class='comma'>,</span> <span class='id identifier rubyid_to_proj'>to_proj</span> <span class='op'>=</span> <span class='id identifier rubyid_loadDB'>loadDB</span><span class='lparen'>(</span><span class='id identifier rubyid_db2path'>db2path</span><span class='rparen'>)</span>
      <span class='comment'>#$db,$proj = loadDB(db2path)
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_to_db'>to_db</span><span class='comma'>,</span> <span class='id identifier rubyid_to_proj'>to_proj</span> <span class='op'>=</span> <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$proj</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># Set working database to source database to prepare for reading
</span>  <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$pj</span> <span class='op'>=</span> <span class='id identifier rubyid_from_db'>from_db</span><span class='comma'>,</span> <span class='id identifier rubyid_from_proj'>from_proj</span>

  <span class='comment'># Construct a hash to store columns and cells we are transferring
</span>  <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fetching columns...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_col_map'>col_map</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_cell_map'>cell_map</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_col'>col</span> <span class='kw'>in</span> <span class='id identifier rubyid_varnames'>varnames</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_getColumn'>getColumn</span><span class='lparen'>(</span><span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Warning: column </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_c'>c</span><span class='embexpr_end'>}</span><span class='tstring_content'> not found! Skipping...</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>next</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_col_map'>col_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_col'>col</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span>
      <span class='id identifier rubyid_cell_map'>cell_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_col'>col</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span>
      <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Read column : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Set working database to destination database to prepare for writing
</span>  <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$pj</span> <span class='op'>=</span> <span class='id identifier rubyid_to_db'>to_db</span><span class='comma'>,</span> <span class='id identifier rubyid_to_proj'>to_proj</span>

  <span class='comment'># Go through the hashmaps and reconstruct the columns
</span>  <span class='kw'>begin</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_key'>key</span> <span class='kw'>in</span> <span class='id identifier rubyid_col_map'>col_map</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
      <span class='id identifier rubyid_col'>col</span> <span class='op'>=</span> <span class='id identifier rubyid_col_map'>col_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_cells'>cells</span> <span class='op'>=</span> <span class='id identifier rubyid_cell_map'>cell_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_arglist'>arglist</span> <span class='op'>=</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span>

      <span class='comment'># Construct a new variable and add all associated cells
</span>      <span class='id identifier rubyid_newvar'>newvar</span> <span class='op'>=</span> <span class='id identifier rubyid_createVariable'>createVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
      <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='id identifier rubyid_cells'>cells</span>
        <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_newvar'>newvar</span><span class='period'>.</span><span class='id identifier rubyid_make_new_cell'>make_new_cell</span><span class='lparen'>(</span><span class='rparen'>)</span>
        <span class='comment'># Clone the existing cell arguments to the new cell.
</span>        <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
          <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_arg'>change_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='rbrace'>}</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_setVariable'>setVariable</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_newvar'>newvar</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrote column : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_newvar'>newvar</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> cells</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed trying to write column </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_col'>col</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># Save the database to file if applicable
</span>  <span class='id identifier rubyid_saveDB'>saveDB</span><span class='lparen'>(</span><span class='id identifier rubyid_db2path'>db2path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_db2path'>db2path</span><span class='op'>!=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Final step: take care of deleting columns from source database if option is set.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_remove'>remove</span>
    <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$pj</span> <span class='op'>=</span> <span class='id identifier rubyid_from_db'>from_db</span><span class='comma'>,</span> <span class='id identifier rubyid_from_proj'>from_proj</span>

    <span class='comment'># Use our hashmap since it takes care of improper column names (returned nil from getColumn())
</span>    <span class='id identifier rubyid_col_map'>col_map</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
      <span class='id identifier rubyid_delete_column'>delete_column</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_saveDB'>saveDB</span><span class='lparen'>(</span><span class='id identifier rubyid_db1path'>db1path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_db1path'>db1path</span><span class='op'>!=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># Restore the saved database and project globals
</span>  <span class='gvar'>$db</span><span class='comma'>,</span> <span class='gvar'>$proj</span> <span class='op'>=</span> <span class='id identifier rubyid_saved_db'>saved_db</span><span class='comma'>,</span> <span class='id identifier rubyid_saved_proj'>saved_proj</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Transfer completed successfully!</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Mon Mar  7 16:03:07 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.0.0).
</div>

  </body>
</html>