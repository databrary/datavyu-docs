===============================
Data Viewer Controller Overview
===============================

The Data Viewer Controller enables users to manipulate the playback of 
their data source, and create new cells as they record their observations.

.. figure:: /img/data-viewer-controller.png
   :alt: Image of the Data Viewer Controller
   :align: center

   [caption]

The Data Viewer Controller has two main areas: the keypad on the left,
which maps directly to your keypad, and the :guilabel:`Timeslider` on
the right, which represents the current playback position, and provides
additional functionality to control and customize playback.

The following sections describe the two areas in detail, and provide
a useful reference for working with the Data Viewer Controller.

Keypad
------

The Data Viewer Controller's keypad maps directly to the number pad
on your keyboard or external keypad: the on-screen representation
helps users remember what key performs what function. When a key on
the keypad is depressed, a visual indicator onscreen mirrors the
keystrokes.

.. note:: 

   The Data Viewer Controller maps playback controls to the keys of your
   keypad. The names of the keys shown on the Data Viewer Controller
   (e.g. ``clear``, ``*``, ``/`` as the top row) may not map directly to
   the name or ordering of keys on your keypad. Some keypads may
   have a ``Num Lock`` key rather than ``clear``, for instance; others
   transpose the ``*`` and ``/`` keys. Play around with your keypad
   and the Data Viewer Controller to verify the key bindings for your
   keypad.

.. _playback-controls:

Playback Controls
~~~~~~~~~~~~~~~~~

.. important:: 

   You cannot use the keypad for inputting numbers into Datavyu: it will
   only perform the actions described here.

- :guilabel:`jog left` (``1``): moves the playhead back one frame. If the
  :term:`frame rate` is not set, :guilabel:`jog` will move the playhead
  in one second increments. Holding down :guilabel:`jog left` plays
  backward slowly.

- :guilabel:`play/pause` (``2``): pauses playback. Pressing
  :guilabel:`play/pause` again resumes playback. :guilabel:`play/pause`
  only works if :guilabel:`play` has first been pushed.

- :guilabel:`jog right` (``3``): moves the playhead forward one frame. If the
  :term:`frame rate` is not set, :guilabel:`jog` will move the playhead
  in one second increments. Holding down :guilabel:`jog right` plays
  forward slowly.

- :guilabel:`shuttle left` (``4``): rewinds, initially at 1/32 of playback speed.
  Repeatedly pressing the :guilabel:`shuttle left` key increases the rewind
  speed to a maximum of 32 times playback speed.

- :guilabel:`stop` (``5``): stops playback.

- :guilabel:`shuttle right` (``6``): fast forwards initially at 1/32 of playback
  speed. Repeatedly pressing the :guilabel:`shuttle right` key increases
  the fast forward speed to a maximum of 32 times playback speed.

- :guilabel:`rewind` (``7``): rewinds at 32x playback speed.

- :guilabel:`play` (``8``): starts playback.

- :guilabel:`forward` (``9``): fast forwards at 32x playback speed.

.. _coding-controls:

Coding Controls
~~~~~~~~~~~~~~~

- :guilabel:`set cell onset` (``clear``): sets the :term:`onset` for the current
  observation / cell.

- :guilabel:`point cell` (``*``): creates a new cell whose :term:`onset` and
  :term:`offset` values are the playhead's current position.

- :guilabel:`set cell offset` (``/`` and ``.``): sets the :term:`offset` for the
  current observation / cell.

- :guilabel:`find` (``+``): moves the playhead to the :term:`onset` time of the the
  time that is shown in the box to the right of the :guilabel:`find`
  button. By default, this is the :term:`onset` time for the
  currently-selected cell. You can change the time by selecting that box
  and editing the value.

- :guilabel:`go back` (``-``): moves the playhead back by the amount
  of time set in the box to the right of the :guilabel:`go back`
  button. You can change the increment by selecting that box and editing
  the value.

- :guilabel:`create new cell and set previous onset` (``0``): creates a new
  cell and sets its :term:`onset` to the playhead's current
  time. If the previous cell does not have a :term:`offset`,
  adding a new cell with this key sets the previous cell's
  :term:`offset` to the current playhead time, minus 1ms.

- :guilabel:`create new cell` (``Enter``): creates a new cell and sets
  its :term:`onset` to the playhead's current time.

Tracks
------
.. TODO: explain what regions are and how they work once you understand

The :guilabel:`Tracks` area of the Data Viewer controller denotes data
source playback stuff. You can control the scale
using the slider bar in the top right. Moving
it to the right shows a smaller scale, [words].  The red
:term:`playhead` shows the current playback position.

You can choose to focus on a single region by moving the green bracketing
dividers. Datavyu will start playback from the leftmost bracket's position,
and stop at the rightmost bracket.

The :guilabel:`Tracks` area of the Data Viewer Controller also
includes five buttons:

- :guilabel:`Lock All`: [use is currently unclear]

- :guilabel:`Add Bookmark`: adds a bookmark at the playhead.

- :guilabel:`Snap Region`: sets the :term:`region` to the length of the selected
  cell: the left bracket is placed at the cell's :term:`onset`, and the
  right bracket at the cell's :term:`offset`. You can also use the
  ``ctrl +`` keyboard shortcut to snap the region.

- :guilabel:`Clear Region`: removes the region delineators. You can
  also use the ``ctrl -`` keyboard shortcut to clear the region.

- :guilabel:`magnifying glass` icon: [use currently unclear]

Extra Keyboard Shortcuts
------------------------

Datavyu includes a number of additional keyboard shortcuts to help you
quickly and efficiently code your data sources:

- ``shift`` :guilabel:`find` (``+``): jumps to the cell
  :term:`offset`. 

- ``cmd T`` toggles temporal ordering.


.. seealso::

   - :doc:`/guide/spreadsheet`
   
   - :doc:`/guide/tutorials`
