====================
Spreadsheet Overview
====================

.. TODO: paragraph stolen from walkthrough.txt - you should make it not be.

The Datavyu Spreadsheet is where coders record
:term:`observations <observation>`. The spreadsheet is the core of Datavyu. By
:ref:`configuring columns <configure-columns>`, coders can record
observations and link them directly to timestamps in the data source.

Each user-defined column is represented by a column in the
spreadsheet. Observations are presented by :term:`cells <cell>`, rectangles in
within a column that contain the observation's data. Cells stack on top
of each other in sequence. Looking horizontally across thecolumn
columns shows what was happening at a given point in time in the data
source. Looking vertically down a column shows the sequence in which
that column type occurred.

.. figure:: /img/spreadsheet.png
   :alt: Image of a typical Datavyu spreadsheet with n study columns
   :align: center
   
   A typical Datavyu spreadsheet. The "BabyLocation" column is
   currently selected, as indicated by the blue background in the
   header row. Note the :guilabel:`plus` icon in the
   top right, which you use to add new :term:`columns <column>`.

Datavyu automatically links the times coded in the spreadsheet to the
current time in the data source. This allows coders to record
the :term:`onset` and :term:`offset` times of events into
the spreadsheet. Coders can also jump to the relevant time in the data source by
selecting a cell in the spreadsheet.

.. _columns:

Columns
-------

Datavyu supports three types of columns: *text*, *nominal*, and
*matrix*. Using combinations of these column types, you can [do stuff].
Each column that a user adds occupies its own column in the
spreadsheet.

.. _column-types:
.. _variable-types:

Column Types
~~~~~~~~~~~~

Text Column
```````````

The *text column* is the more straightforward column type, being a
simple text field. Text columns are ideal for storing (information),
and (so on).

Here's a sample observation for a text column:

.. TODO: example of a typical text column observation

Nominal Columns
```````````````

.. next sentence stolen from wikipedia

*Nominal columns* are "columns with values which have no numerical
value, such as gender or occupation". These are useful for recording
facts about the study participant.

A typical nominal column might resemble the following:

.. TODO: example of a typical nominal column

Matrix Columns
``````````````

Matrix columns are key - value pairs, represented in the
following form: ::

   <columnname>(<arg01:N>, <arg02:N>, ... , <argn:N>)

Using the :ref:`Vocab Editor <vocab-editor>`, you can configure matrix
columns to represent any number of observations.

Matrix columns have :term:`codes <code>`, which represent the
feature that is being studied. For instance, an argument could be "Left
hand touch", or "Hesitation", or "Focus". When a coder codes the data
source, he or she might record the presence or absence of these
arguments. A matrix column must have *at least* one argument, but may
have as many as desired. See: the :doc:`column configuration
</guide/tutorial/configure-datavyu-columns>` tutorial provides
instructions for configuring matrix columns.

.. _hide-show-columns:

Hide and Show Columns
~~~~~~~~~~~~~~~~~~~~~

To hide a column, select the column by clicking on its name. Selected
column will have a blue background. You can select multiple columns by
Cmd-clicking (on Mac) or Ctrl-clicking (on Windows). Then, in the
:guilabel:`Spreadsheet` menu, select :guilabel:`Hide Selected
Columns`.

To show a column, select :guilabel:`Spreadsheet`, and then choose
:guilabel:`Show All Columns`.

You can also control a column's visibility form the :guilabel:`Column
List`, which you access from the :guilabel:`Spreadsheet` menu. The
:guilabel:`Column List` lists all the columns in a spreadsheet, and
includes a check box which you can use to toggle its visiblity.

.. _rearrange-columns:

Rearrange Columns
~~~~~~~~~~~~~~~~~

To rearrange columns within the Spreadsheet, simply click the column's
name and drag it to the desired location.

Cells
-----

Cells are at the core of Datavyu: each cell represents an observation
recorded by the coder. 

.. image:: /img/cell-zoomin.svg
   :align: center
   :alt: Zoomed-in view of a Datavyu cell, labeling its codes, onset, and offset.


.. TODO: is there a limit on the number of arguments?

.. TODO: Sample matrix column arrangement.




.. Spreadsheet Interpretation
   --------------------------

.. TODO: describe what the page looks like when coded & so on.

.. seealso::

   - :doc:`/guide/tutorials`
