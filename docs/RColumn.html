<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: RColumn
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "RColumn";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (R)</a> &raquo;
    
    
    <span class="title">RColumn</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: RColumn
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">RColumn</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>datavyu_api.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Ruby implementation of Datavyu column.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#arglist-instance_method" title="#arglist (instance method)">#<strong>arglist</strong>  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Names of codes for cell in this column, excluding onset, offset, and ordinal.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#cells-instance_method" title="#cells (instance method)">#<strong>cells</strong>  &#x21d2; Array&lt;RCell&gt; </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>List of cells in this column.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#db_var-instance_method" title="#db_var (instance method)">#<strong>db_var</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Java object for this column.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dirty-instance_method" title="#dirty (instance method)">#<strong>dirty</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute dirty.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#hidden-instance_method" title="#hidden (instance method)">#<strong>hidden</strong>  &#x21d2; true, false </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Visibility of column in spreadsheet.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Name of the column.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#old_args-instance_method" title="#old_args (instance method)">#<strong>old_args</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute old_args.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">#<strong>type</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute type.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sanitize_codename-class_method" title="sanitize_codename (class method)">.<strong>sanitize_codename</strong>(name)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Validate code name.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_code-instance_method" title="#add_code (instance method)">#<strong>add_code</strong>(name)  &#x21d2; Object </a>
    

    
      (also: #add_arg)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a code to this column.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#change_code_name-instance_method" title="#change_code_name (instance method)">#<strong>change_code_name</strong>(old_name, new_name)  &#x21d2; Object </a>
    

    
      (also: #change_arg_name)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Changes the name of a code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#convert_argname-instance_method" title="#convert_argname (instance method)">#<strong>convert_argname</strong>(arg)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; RColumn </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of RColumn.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_cell-instance_method" title="#new_cell (instance method)">#<strong>new_cell</strong>(cell = nil)  &#x21d2; RCell </a>
    

    
      (also: #make_new_cell, #create_cell)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a new, blank cell at the end of this variable&#39;s cell array.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_code-instance_method" title="#remove_code (instance method)">#<strong>remove_code</strong>(name)  &#x21d2; Object </a>
    

    
      (also: #remove_arg)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove a code from this column.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resample-instance_method" title="#resample (instance method)">#<strong>resample</strong>(step, opts = {})  &#x21d2; RColumn </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resamples the cells of this column using given step size.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_cells-instance_method" title="#set_cells (instance method)">#<strong>set_cells</strong>(newcells, arglist)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates the cell object in the Variable object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_hidden-instance_method" title="#set_hidden (instance method)">#<strong>set_hidden</strong>(value)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set hidden state of this column.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sort_cells-instance_method" title="#sort_cells (instance method)">#<strong>sort_cells</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sorts cells and saves column&#39;s cells by ascending onset times.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of RColumn</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 336</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="arglist=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="arglist-instance_method">
  
    #<strong>arglist</strong>  &#x21d2; <tt>Array&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns names of codes for cell in this column, excluding onset, offset, and ordinal</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>names of codes for cell in this column, excluding onset, offset, and ordinal</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 332</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span>

  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='symbol'>:cells</span><span class='comma'>,</span> <span class='symbol'>:arglist</span><span class='comma'>,</span> <span class='symbol'>:old_args</span><span class='comma'>,</span> <span class='symbol'>:dirty</span><span class='comma'>,</span> <span class='symbol'>:db_var</span><span class='comma'>,</span> <span class='symbol'>:hidden</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='comment'># Validate code name. Replace non-alphanumeric characters
</span>  <span class='comment'># with underscores and prepend an underscore if the code
</span>  <span class='comment'># starts with a number.
</span>  <span class='comment'># @param name string to validate
</span>  <span class='comment'># @return [String] validated code name
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'>sanitize_codename</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^\d{1})</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_\\1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># @note This function is not for general use.
</span>  <span class='comment'># Creates the cell object in the Variable object.
</span>  <span class='comment'># @param newcells (required): Array of cells coming from the database via get_column
</span>  <span class='comment'># @param arglist (required): Array of the names of the arguments from the database
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_newcells'>newcells</span><span class='comma'>,</span> <span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Setting cells</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@cells</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='ivar'>@arglist</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='comment'># Regex to delete any character not a-z,0-9,or _
</span>      <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='id identifier rubyid_arg'>arg</span>
      <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_ord'>ord</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
        <span class='id identifier rubyid_ord'>ord</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
        <span class='id identifier rubyid_vals'>vals</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
          <span class='kw'>for</span> <span class='id identifier rubyid_val'>val</span> <span class='kw'>in</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span>
            <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='id identifier rubyid_vals'>vals</span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_ord'>ord</span>
        <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Creates a new, blank cell at the end of this variable&#39;s cell array.
</span>  <span class='comment'># If a template cell is provided, copies over onset and offset times and code values for any matching code names.
</span>  <span class='comment'># @param cell [RCell] template cell
</span>  <span class='comment'># @return [RCell] Reference to the cell that was just created.  Modify the cell using this reference.
</span>  <span class='comment'># @example
</span>  <span class='comment'>#   trial = get_column(&quot;trial&quot;)
</span>  <span class='comment'>#   new_cell = trial.new_cell()
</span>  <span class='comment'>#   new_cell.onset = 1000
</span>  <span class='comment'>#   set_column(trial)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_new_cell'>new_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
    <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_c'>c</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:make_new_cell</span> <span class='symbol'>:new_cell</span>
  <span class='kw'>alias</span> <span class='symbol'>:create_cell</span> <span class='symbol'>:new_cell</span>

  <span class='comment'># Sorts cells and saves column&#39;s cells by ascending onset times.
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_sort_cells'>sort_cells</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># Changes the name of a code. Updates the name for all cells in the column
</span>  <span class='comment'># @param old_name the name of the argument you want to change
</span>  <span class='comment'># @param new_name the name you want to change old_name to
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>

    <span class='comment'># Sanitize code
</span>    <span class='id identifier rubyid_old_name'>old_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:change_arg_name</span> <span class='symbol'>:change_code_name</span>

  <span class='comment'># Add a code to this column. Updates all cells in column with new code.
</span>  <span class='comment'># @param [String] name the name of the new code
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_add_code'>add_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_san_name'>san_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_add_arg'>add_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:add_arg</span> <span class='symbol'>:add_code</span>

  <span class='comment'># Remove a code from this column. Updates all cells in column.
</span>  <span class='comment'># @param [String] name the name of the code to remove
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remove_code'>remove_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>

    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_remove_arg'>remove_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:remove_arg</span> <span class='symbol'>:remove_code</span>

  <span class='comment'># Set hidden state of this column
</span>  <span class='comment'># @param value [true, false] true to hide column in spreadsheet, false to show
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_hidden'>set_hidden</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@hidden</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='comment'># Resamples the cells of this column using given step size.
</span>  <span class='comment'># Optionally can specify the start and end time-points.
</span>  <span class='comment'># @param [Integer] step step size to resample with, in milliseconds
</span>  <span class='comment'># @param [Hash] opts options
</span>  <span class='comment'># @option opts [String] :column_name (self.name) name of returned column
</span>  <span class='comment'># @option opts [Integer] :start_time (earliest onset) time to start resampling from, in milliseconds
</span>  <span class='comment'># @option opts [Integer] :stop_time (latest offset) time to stop resampling at, in milliseconds
</span>  <span class='comment'># @return [RColumn] new column with resampled cells
</span>  <span class='comment'># @note Undefined behavior for columns whose cells overlap with each other.
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_resample'>resample</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='ivar'>@resample_defaults</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:column_name</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
      <span class='symbol'>:start_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:earliest</span><span class='comma'>,</span>
      <span class='symbol'>:stop_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:latest</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@resample_defaults</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:earliest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:latest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='kw'>end</span>

    <span class='comment'># Construct new column
</span>    <span class='id identifier rubyid_ncol'>ncol</span> <span class='op'>=</span> <span class='id identifier rubyid_new_column'><span class='object_link'><a href="top-level-namespace.html#new_column-instance_method" title="#new_column (method)">new_column</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:column_name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='comment'># Construct new cells spanning range.
</span>    <span class='lparen'>(</span> <span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_step'>step</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_time'>time</span><span class='op'>|</span>
      <span class='id identifier rubyid_ncell'>ncell</span> <span class='op'>=</span> <span class='id identifier rubyid_ncol'>ncol</span><span class='period'>.</span><span class='id identifier rubyid_new_cell'>new_cell</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>+</span> <span class='id identifier rubyid_step'>step</span> <span class='op'>-</span> <span class='int'>1</span>

      <span class='comment'># Find overlapping cells from self in this time region
</span>      <span class='id identifier rubyid_overlap_cells'>overlap_cells</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlaps_cell'>overlaps_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='comment'># if overlap_cells.empty?
</span>      <span class='comment'>#   puts &quot;no source cell for time #{time}&quot;
</span>      <span class='comment'>#   next
</span>      <span class='comment'># end
</span>      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'># no source cell
</span>
      <span class='comment'># Map each to their intersecting region and find the one with the largest duration.
</span>      <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span> <span class='op'>=</span>  <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span>
        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d1'>d1</span> <span class='op'>=</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_r2'>r2</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>=</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_d1'>d1</span> <span class='comment'># largest first
</span>      <span class='kw'>end</span>
      <span class='id identifier rubyid_winner'>winner</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_winner'>winner</span><span class='period'>.</span><span class='id identifier rubyid_get_code'>get_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='comment'># p ncol.cells.size
</span>    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_ncol'>ncol</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cells=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cells-instance_method">
  
    #<strong>cells</strong>  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns list of cells in this column</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>list of cells in this column</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 332</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span>

  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='symbol'>:cells</span><span class='comma'>,</span> <span class='symbol'>:arglist</span><span class='comma'>,</span> <span class='symbol'>:old_args</span><span class='comma'>,</span> <span class='symbol'>:dirty</span><span class='comma'>,</span> <span class='symbol'>:db_var</span><span class='comma'>,</span> <span class='symbol'>:hidden</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='comment'># Validate code name. Replace non-alphanumeric characters
</span>  <span class='comment'># with underscores and prepend an underscore if the code
</span>  <span class='comment'># starts with a number.
</span>  <span class='comment'># @param name string to validate
</span>  <span class='comment'># @return [String] validated code name
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'>sanitize_codename</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^\d{1})</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_\\1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># @note This function is not for general use.
</span>  <span class='comment'># Creates the cell object in the Variable object.
</span>  <span class='comment'># @param newcells (required): Array of cells coming from the database via get_column
</span>  <span class='comment'># @param arglist (required): Array of the names of the arguments from the database
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_newcells'>newcells</span><span class='comma'>,</span> <span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Setting cells</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@cells</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='ivar'>@arglist</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='comment'># Regex to delete any character not a-z,0-9,or _
</span>      <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='id identifier rubyid_arg'>arg</span>
      <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_ord'>ord</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
        <span class='id identifier rubyid_ord'>ord</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
        <span class='id identifier rubyid_vals'>vals</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
          <span class='kw'>for</span> <span class='id identifier rubyid_val'>val</span> <span class='kw'>in</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span>
            <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='id identifier rubyid_vals'>vals</span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_ord'>ord</span>
        <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Creates a new, blank cell at the end of this variable&#39;s cell array.
</span>  <span class='comment'># If a template cell is provided, copies over onset and offset times and code values for any matching code names.
</span>  <span class='comment'># @param cell [RCell] template cell
</span>  <span class='comment'># @return [RCell] Reference to the cell that was just created.  Modify the cell using this reference.
</span>  <span class='comment'># @example
</span>  <span class='comment'>#   trial = get_column(&quot;trial&quot;)
</span>  <span class='comment'>#   new_cell = trial.new_cell()
</span>  <span class='comment'>#   new_cell.onset = 1000
</span>  <span class='comment'>#   set_column(trial)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_new_cell'>new_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
    <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_c'>c</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:make_new_cell</span> <span class='symbol'>:new_cell</span>
  <span class='kw'>alias</span> <span class='symbol'>:create_cell</span> <span class='symbol'>:new_cell</span>

  <span class='comment'># Sorts cells and saves column&#39;s cells by ascending onset times.
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_sort_cells'>sort_cells</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># Changes the name of a code. Updates the name for all cells in the column
</span>  <span class='comment'># @param old_name the name of the argument you want to change
</span>  <span class='comment'># @param new_name the name you want to change old_name to
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>

    <span class='comment'># Sanitize code
</span>    <span class='id identifier rubyid_old_name'>old_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:change_arg_name</span> <span class='symbol'>:change_code_name</span>

  <span class='comment'># Add a code to this column. Updates all cells in column with new code.
</span>  <span class='comment'># @param [String] name the name of the new code
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_add_code'>add_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_san_name'>san_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_add_arg'>add_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:add_arg</span> <span class='symbol'>:add_code</span>

  <span class='comment'># Remove a code from this column. Updates all cells in column.
</span>  <span class='comment'># @param [String] name the name of the code to remove
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remove_code'>remove_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>

    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_remove_arg'>remove_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:remove_arg</span> <span class='symbol'>:remove_code</span>

  <span class='comment'># Set hidden state of this column
</span>  <span class='comment'># @param value [true, false] true to hide column in spreadsheet, false to show
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_hidden'>set_hidden</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@hidden</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='comment'># Resamples the cells of this column using given step size.
</span>  <span class='comment'># Optionally can specify the start and end time-points.
</span>  <span class='comment'># @param [Integer] step step size to resample with, in milliseconds
</span>  <span class='comment'># @param [Hash] opts options
</span>  <span class='comment'># @option opts [String] :column_name (self.name) name of returned column
</span>  <span class='comment'># @option opts [Integer] :start_time (earliest onset) time to start resampling from, in milliseconds
</span>  <span class='comment'># @option opts [Integer] :stop_time (latest offset) time to stop resampling at, in milliseconds
</span>  <span class='comment'># @return [RColumn] new column with resampled cells
</span>  <span class='comment'># @note Undefined behavior for columns whose cells overlap with each other.
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_resample'>resample</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='ivar'>@resample_defaults</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:column_name</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
      <span class='symbol'>:start_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:earliest</span><span class='comma'>,</span>
      <span class='symbol'>:stop_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:latest</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@resample_defaults</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:earliest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:latest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='kw'>end</span>

    <span class='comment'># Construct new column
</span>    <span class='id identifier rubyid_ncol'>ncol</span> <span class='op'>=</span> <span class='id identifier rubyid_new_column'><span class='object_link'><a href="top-level-namespace.html#new_column-instance_method" title="#new_column (method)">new_column</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:column_name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='comment'># Construct new cells spanning range.
</span>    <span class='lparen'>(</span> <span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_step'>step</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_time'>time</span><span class='op'>|</span>
      <span class='id identifier rubyid_ncell'>ncell</span> <span class='op'>=</span> <span class='id identifier rubyid_ncol'>ncol</span><span class='period'>.</span><span class='id identifier rubyid_new_cell'>new_cell</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>+</span> <span class='id identifier rubyid_step'>step</span> <span class='op'>-</span> <span class='int'>1</span>

      <span class='comment'># Find overlapping cells from self in this time region
</span>      <span class='id identifier rubyid_overlap_cells'>overlap_cells</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlaps_cell'>overlaps_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='comment'># if overlap_cells.empty?
</span>      <span class='comment'>#   puts &quot;no source cell for time #{time}&quot;
</span>      <span class='comment'>#   next
</span>      <span class='comment'># end
</span>      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'># no source cell
</span>
      <span class='comment'># Map each to their intersecting region and find the one with the largest duration.
</span>      <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span> <span class='op'>=</span>  <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span>
        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d1'>d1</span> <span class='op'>=</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_r2'>r2</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>=</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_d1'>d1</span> <span class='comment'># largest first
</span>      <span class='kw'>end</span>
      <span class='id identifier rubyid_winner'>winner</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_winner'>winner</span><span class='period'>.</span><span class='id identifier rubyid_get_code'>get_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='comment'># p ncol.cells.size
</span>    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_ncol'>ncol</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="db_var=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="db_var-instance_method">
  
    #<strong>db_var</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Not intended for general use. Modify at own risk.</p>
</div>
  </div>


<p>Returns Java object for this column</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Java object for this column</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 332</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span>

  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='symbol'>:cells</span><span class='comma'>,</span> <span class='symbol'>:arglist</span><span class='comma'>,</span> <span class='symbol'>:old_args</span><span class='comma'>,</span> <span class='symbol'>:dirty</span><span class='comma'>,</span> <span class='symbol'>:db_var</span><span class='comma'>,</span> <span class='symbol'>:hidden</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='comment'># Validate code name. Replace non-alphanumeric characters
</span>  <span class='comment'># with underscores and prepend an underscore if the code
</span>  <span class='comment'># starts with a number.
</span>  <span class='comment'># @param name string to validate
</span>  <span class='comment'># @return [String] validated code name
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'>sanitize_codename</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^\d{1})</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_\\1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># @note This function is not for general use.
</span>  <span class='comment'># Creates the cell object in the Variable object.
</span>  <span class='comment'># @param newcells (required): Array of cells coming from the database via get_column
</span>  <span class='comment'># @param arglist (required): Array of the names of the arguments from the database
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_newcells'>newcells</span><span class='comma'>,</span> <span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Setting cells</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@cells</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='ivar'>@arglist</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='comment'># Regex to delete any character not a-z,0-9,or _
</span>      <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='id identifier rubyid_arg'>arg</span>
      <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_ord'>ord</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
        <span class='id identifier rubyid_ord'>ord</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
        <span class='id identifier rubyid_vals'>vals</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
          <span class='kw'>for</span> <span class='id identifier rubyid_val'>val</span> <span class='kw'>in</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span>
            <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='id identifier rubyid_vals'>vals</span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_ord'>ord</span>
        <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Creates a new, blank cell at the end of this variable&#39;s cell array.
</span>  <span class='comment'># If a template cell is provided, copies over onset and offset times and code values for any matching code names.
</span>  <span class='comment'># @param cell [RCell] template cell
</span>  <span class='comment'># @return [RCell] Reference to the cell that was just created.  Modify the cell using this reference.
</span>  <span class='comment'># @example
</span>  <span class='comment'>#   trial = get_column(&quot;trial&quot;)
</span>  <span class='comment'>#   new_cell = trial.new_cell()
</span>  <span class='comment'>#   new_cell.onset = 1000
</span>  <span class='comment'>#   set_column(trial)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_new_cell'>new_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
    <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_c'>c</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:make_new_cell</span> <span class='symbol'>:new_cell</span>
  <span class='kw'>alias</span> <span class='symbol'>:create_cell</span> <span class='symbol'>:new_cell</span>

  <span class='comment'># Sorts cells and saves column&#39;s cells by ascending onset times.
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_sort_cells'>sort_cells</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># Changes the name of a code. Updates the name for all cells in the column
</span>  <span class='comment'># @param old_name the name of the argument you want to change
</span>  <span class='comment'># @param new_name the name you want to change old_name to
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>

    <span class='comment'># Sanitize code
</span>    <span class='id identifier rubyid_old_name'>old_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:change_arg_name</span> <span class='symbol'>:change_code_name</span>

  <span class='comment'># Add a code to this column. Updates all cells in column with new code.
</span>  <span class='comment'># @param [String] name the name of the new code
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_add_code'>add_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_san_name'>san_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_add_arg'>add_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:add_arg</span> <span class='symbol'>:add_code</span>

  <span class='comment'># Remove a code from this column. Updates all cells in column.
</span>  <span class='comment'># @param [String] name the name of the code to remove
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remove_code'>remove_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>

    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_remove_arg'>remove_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:remove_arg</span> <span class='symbol'>:remove_code</span>

  <span class='comment'># Set hidden state of this column
</span>  <span class='comment'># @param value [true, false] true to hide column in spreadsheet, false to show
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_hidden'>set_hidden</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@hidden</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='comment'># Resamples the cells of this column using given step size.
</span>  <span class='comment'># Optionally can specify the start and end time-points.
</span>  <span class='comment'># @param [Integer] step step size to resample with, in milliseconds
</span>  <span class='comment'># @param [Hash] opts options
</span>  <span class='comment'># @option opts [String] :column_name (self.name) name of returned column
</span>  <span class='comment'># @option opts [Integer] :start_time (earliest onset) time to start resampling from, in milliseconds
</span>  <span class='comment'># @option opts [Integer] :stop_time (latest offset) time to stop resampling at, in milliseconds
</span>  <span class='comment'># @return [RColumn] new column with resampled cells
</span>  <span class='comment'># @note Undefined behavior for columns whose cells overlap with each other.
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_resample'>resample</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='ivar'>@resample_defaults</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:column_name</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
      <span class='symbol'>:start_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:earliest</span><span class='comma'>,</span>
      <span class='symbol'>:stop_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:latest</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@resample_defaults</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:earliest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:latest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='kw'>end</span>

    <span class='comment'># Construct new column
</span>    <span class='id identifier rubyid_ncol'>ncol</span> <span class='op'>=</span> <span class='id identifier rubyid_new_column'><span class='object_link'><a href="top-level-namespace.html#new_column-instance_method" title="#new_column (method)">new_column</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:column_name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='comment'># Construct new cells spanning range.
</span>    <span class='lparen'>(</span> <span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_step'>step</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_time'>time</span><span class='op'>|</span>
      <span class='id identifier rubyid_ncell'>ncell</span> <span class='op'>=</span> <span class='id identifier rubyid_ncol'>ncol</span><span class='period'>.</span><span class='id identifier rubyid_new_cell'>new_cell</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>+</span> <span class='id identifier rubyid_step'>step</span> <span class='op'>-</span> <span class='int'>1</span>

      <span class='comment'># Find overlapping cells from self in this time region
</span>      <span class='id identifier rubyid_overlap_cells'>overlap_cells</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlaps_cell'>overlaps_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='comment'># if overlap_cells.empty?
</span>      <span class='comment'>#   puts &quot;no source cell for time #{time}&quot;
</span>      <span class='comment'>#   next
</span>      <span class='comment'># end
</span>      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'># no source cell
</span>
      <span class='comment'># Map each to their intersecting region and find the one with the largest duration.
</span>      <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span> <span class='op'>=</span>  <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span>
        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d1'>d1</span> <span class='op'>=</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_r2'>r2</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>=</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_d1'>d1</span> <span class='comment'># largest first
</span>      <span class='kw'>end</span>
      <span class='id identifier rubyid_winner'>winner</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_winner'>winner</span><span class='period'>.</span><span class='id identifier rubyid_get_code'>get_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='comment'># p ncol.cells.size
</span>    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_ncol'>ncol</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="dirty=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="dirty-instance_method">
  
    #<strong>dirty</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute dirty</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 334</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dirty'>dirty</span>
  <span class='ivar'>@dirty</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="hidden=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="hidden-instance_method">
  
    #<strong>hidden</strong>  &#x21d2; <tt>true</tt>, <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns visibility of column in spreadsheet</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>visibility of column in spreadsheet</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 332</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span>

  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='symbol'>:cells</span><span class='comma'>,</span> <span class='symbol'>:arglist</span><span class='comma'>,</span> <span class='symbol'>:old_args</span><span class='comma'>,</span> <span class='symbol'>:dirty</span><span class='comma'>,</span> <span class='symbol'>:db_var</span><span class='comma'>,</span> <span class='symbol'>:hidden</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='comment'># Validate code name. Replace non-alphanumeric characters
</span>  <span class='comment'># with underscores and prepend an underscore if the code
</span>  <span class='comment'># starts with a number.
</span>  <span class='comment'># @param name string to validate
</span>  <span class='comment'># @return [String] validated code name
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'>sanitize_codename</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^\d{1})</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_\\1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># @note This function is not for general use.
</span>  <span class='comment'># Creates the cell object in the Variable object.
</span>  <span class='comment'># @param newcells (required): Array of cells coming from the database via get_column
</span>  <span class='comment'># @param arglist (required): Array of the names of the arguments from the database
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_newcells'>newcells</span><span class='comma'>,</span> <span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Setting cells</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@cells</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='ivar'>@arglist</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='comment'># Regex to delete any character not a-z,0-9,or _
</span>      <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='id identifier rubyid_arg'>arg</span>
      <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_ord'>ord</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
        <span class='id identifier rubyid_ord'>ord</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
        <span class='id identifier rubyid_vals'>vals</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
          <span class='kw'>for</span> <span class='id identifier rubyid_val'>val</span> <span class='kw'>in</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span>
            <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='id identifier rubyid_vals'>vals</span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_ord'>ord</span>
        <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Creates a new, blank cell at the end of this variable&#39;s cell array.
</span>  <span class='comment'># If a template cell is provided, copies over onset and offset times and code values for any matching code names.
</span>  <span class='comment'># @param cell [RCell] template cell
</span>  <span class='comment'># @return [RCell] Reference to the cell that was just created.  Modify the cell using this reference.
</span>  <span class='comment'># @example
</span>  <span class='comment'>#   trial = get_column(&quot;trial&quot;)
</span>  <span class='comment'>#   new_cell = trial.new_cell()
</span>  <span class='comment'>#   new_cell.onset = 1000
</span>  <span class='comment'>#   set_column(trial)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_new_cell'>new_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
    <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_c'>c</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:make_new_cell</span> <span class='symbol'>:new_cell</span>
  <span class='kw'>alias</span> <span class='symbol'>:create_cell</span> <span class='symbol'>:new_cell</span>

  <span class='comment'># Sorts cells and saves column&#39;s cells by ascending onset times.
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_sort_cells'>sort_cells</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># Changes the name of a code. Updates the name for all cells in the column
</span>  <span class='comment'># @param old_name the name of the argument you want to change
</span>  <span class='comment'># @param new_name the name you want to change old_name to
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>

    <span class='comment'># Sanitize code
</span>    <span class='id identifier rubyid_old_name'>old_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:change_arg_name</span> <span class='symbol'>:change_code_name</span>

  <span class='comment'># Add a code to this column. Updates all cells in column with new code.
</span>  <span class='comment'># @param [String] name the name of the new code
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_add_code'>add_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_san_name'>san_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_add_arg'>add_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:add_arg</span> <span class='symbol'>:add_code</span>

  <span class='comment'># Remove a code from this column. Updates all cells in column.
</span>  <span class='comment'># @param [String] name the name of the code to remove
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remove_code'>remove_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>

    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_remove_arg'>remove_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:remove_arg</span> <span class='symbol'>:remove_code</span>

  <span class='comment'># Set hidden state of this column
</span>  <span class='comment'># @param value [true, false] true to hide column in spreadsheet, false to show
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_hidden'>set_hidden</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@hidden</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='comment'># Resamples the cells of this column using given step size.
</span>  <span class='comment'># Optionally can specify the start and end time-points.
</span>  <span class='comment'># @param [Integer] step step size to resample with, in milliseconds
</span>  <span class='comment'># @param [Hash] opts options
</span>  <span class='comment'># @option opts [String] :column_name (self.name) name of returned column
</span>  <span class='comment'># @option opts [Integer] :start_time (earliest onset) time to start resampling from, in milliseconds
</span>  <span class='comment'># @option opts [Integer] :stop_time (latest offset) time to stop resampling at, in milliseconds
</span>  <span class='comment'># @return [RColumn] new column with resampled cells
</span>  <span class='comment'># @note Undefined behavior for columns whose cells overlap with each other.
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_resample'>resample</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='ivar'>@resample_defaults</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:column_name</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
      <span class='symbol'>:start_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:earliest</span><span class='comma'>,</span>
      <span class='symbol'>:stop_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:latest</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@resample_defaults</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:earliest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:latest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='kw'>end</span>

    <span class='comment'># Construct new column
</span>    <span class='id identifier rubyid_ncol'>ncol</span> <span class='op'>=</span> <span class='id identifier rubyid_new_column'><span class='object_link'><a href="top-level-namespace.html#new_column-instance_method" title="#new_column (method)">new_column</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:column_name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='comment'># Construct new cells spanning range.
</span>    <span class='lparen'>(</span> <span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_step'>step</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_time'>time</span><span class='op'>|</span>
      <span class='id identifier rubyid_ncell'>ncell</span> <span class='op'>=</span> <span class='id identifier rubyid_ncol'>ncol</span><span class='period'>.</span><span class='id identifier rubyid_new_cell'>new_cell</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>+</span> <span class='id identifier rubyid_step'>step</span> <span class='op'>-</span> <span class='int'>1</span>

      <span class='comment'># Find overlapping cells from self in this time region
</span>      <span class='id identifier rubyid_overlap_cells'>overlap_cells</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlaps_cell'>overlaps_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='comment'># if overlap_cells.empty?
</span>      <span class='comment'>#   puts &quot;no source cell for time #{time}&quot;
</span>      <span class='comment'>#   next
</span>      <span class='comment'># end
</span>      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'># no source cell
</span>
      <span class='comment'># Map each to their intersecting region and find the one with the largest duration.
</span>      <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span> <span class='op'>=</span>  <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span>
        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d1'>d1</span> <span class='op'>=</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_r2'>r2</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>=</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_d1'>d1</span> <span class='comment'># largest first
</span>      <span class='kw'>end</span>
      <span class='id identifier rubyid_winner'>winner</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_winner'>winner</span><span class='period'>.</span><span class='id identifier rubyid_get_code'>get_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='comment'># p ncol.cells.size
</span>    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_ncol'>ncol</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns name of the column</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>name of the column</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 332</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span>

  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='symbol'>:cells</span><span class='comma'>,</span> <span class='symbol'>:arglist</span><span class='comma'>,</span> <span class='symbol'>:old_args</span><span class='comma'>,</span> <span class='symbol'>:dirty</span><span class='comma'>,</span> <span class='symbol'>:db_var</span><span class='comma'>,</span> <span class='symbol'>:hidden</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hidden'>hidden</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='comment'># Validate code name. Replace non-alphanumeric characters
</span>  <span class='comment'># with underscores and prepend an underscore if the code
</span>  <span class='comment'># starts with a number.
</span>  <span class='comment'># @param name string to validate
</span>  <span class='comment'># @return [String] validated code name
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'>sanitize_codename</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^\d{1})</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_\\1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sanitized'>sanitized</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># @note This function is not for general use.
</span>  <span class='comment'># Creates the cell object in the Variable object.
</span>  <span class='comment'># @param newcells (required): Array of cells coming from the database via get_column
</span>  <span class='comment'># @param arglist (required): Array of the names of the arguments from the database
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_newcells'>newcells</span><span class='comma'>,</span> <span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Setting cells</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@cells</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='ivar'>@arglist</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
      <span class='comment'># Regex to delete any character not a-z,0-9,or _
</span>      <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='id identifier rubyid_arg'>arg</span>
      <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_ord'>ord</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
        <span class='id identifier rubyid_ord'>ord</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
        <span class='id identifier rubyid_vals'>vals</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
          <span class='kw'>for</span> <span class='id identifier rubyid_val'>val</span> <span class='kw'>in</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span>
            <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='id identifier rubyid_vals'>vals</span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_ord'>ord</span>
        <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Creates a new, blank cell at the end of this variable&#39;s cell array.
</span>  <span class='comment'># If a template cell is provided, copies over onset and offset times and code values for any matching code names.
</span>  <span class='comment'># @param cell [RCell] template cell
</span>  <span class='comment'># @return [RCell] Reference to the cell that was just created.  Modify the cell using this reference.
</span>  <span class='comment'># @example
</span>  <span class='comment'>#   trial = get_column(&quot;trial&quot;)
</span>  <span class='comment'>#   new_cell = trial.new_cell()
</span>  <span class='comment'>#   new_cell.onset = 1000
</span>  <span class='comment'>#   set_column(trial)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_new_cell'>new_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
    <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_c'>c</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:make_new_cell</span> <span class='symbol'>:new_cell</span>
  <span class='kw'>alias</span> <span class='symbol'>:create_cell</span> <span class='symbol'>:new_cell</span>

  <span class='comment'># Sorts cells and saves column&#39;s cells by ascending onset times.
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_sort_cells'>sort_cells</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># Changes the name of a code. Updates the name for all cells in the column
</span>  <span class='comment'># @param old_name the name of the argument you want to change
</span>  <span class='comment'># @param new_name the name you want to change old_name to
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>

    <span class='comment'># Sanitize code
</span>    <span class='id identifier rubyid_old_name'>old_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:change_arg_name</span> <span class='symbol'>:change_code_name</span>

  <span class='comment'># Add a code to this column. Updates all cells in column with new code.
</span>  <span class='comment'># @param [String] name the name of the new code
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_add_code'>add_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_san_name'>san_name</span>
    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_add_arg'>add_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:add_arg</span> <span class='symbol'>:add_code</span>

  <span class='comment'># Remove a code from this column. Updates all cells in column.
</span>  <span class='comment'># @param [String] name the name of the code to remove
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_remove_code'>remove_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>

    <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
      <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_remove_arg'>remove_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>alias</span> <span class='symbol'>:remove_arg</span> <span class='symbol'>:remove_code</span>

  <span class='comment'># Set hidden state of this column
</span>  <span class='comment'># @param value [true, false] true to hide column in spreadsheet, false to show
</span>  <span class='comment'># @return nil
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_set_hidden'>set_hidden</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@hidden</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='comment'># Resamples the cells of this column using given step size.
</span>  <span class='comment'># Optionally can specify the start and end time-points.
</span>  <span class='comment'># @param [Integer] step step size to resample with, in milliseconds
</span>  <span class='comment'># @param [Hash] opts options
</span>  <span class='comment'># @option opts [String] :column_name (self.name) name of returned column
</span>  <span class='comment'># @option opts [Integer] :start_time (earliest onset) time to start resampling from, in milliseconds
</span>  <span class='comment'># @option opts [Integer] :stop_time (latest offset) time to stop resampling at, in milliseconds
</span>  <span class='comment'># @return [RColumn] new column with resampled cells
</span>  <span class='comment'># @note Undefined behavior for columns whose cells overlap with each other.
</span>  <span class='comment'># @since 1.3.6
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_resample'>resample</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='ivar'>@resample_defaults</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:column_name</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
      <span class='symbol'>:start_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:earliest</span><span class='comma'>,</span>
      <span class='symbol'>:stop_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:latest</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@resample_defaults</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:earliest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:latest</span>
      <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='kw'>end</span>

    <span class='comment'># Construct new column
</span>    <span class='id identifier rubyid_ncol'>ncol</span> <span class='op'>=</span> <span class='id identifier rubyid_new_column'><span class='object_link'><a href="top-level-namespace.html#new_column-instance_method" title="#new_column (method)">new_column</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:column_name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
    <span class='comment'># Construct new cells spanning range.
</span>    <span class='lparen'>(</span> <span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_step'>step</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_time'>time</span><span class='op'>|</span>
      <span class='id identifier rubyid_ncell'>ncell</span> <span class='op'>=</span> <span class='id identifier rubyid_ncol'>ncol</span><span class='period'>.</span><span class='id identifier rubyid_new_cell'>new_cell</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>+</span> <span class='id identifier rubyid_step'>step</span> <span class='op'>-</span> <span class='int'>1</span>

      <span class='comment'># Find overlapping cells from self in this time region
</span>      <span class='id identifier rubyid_overlap_cells'>overlap_cells</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlaps_cell'>overlaps_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='comment'># if overlap_cells.empty?
</span>      <span class='comment'>#   puts &quot;no source cell for time #{time}&quot;
</span>      <span class='comment'>#   next
</span>      <span class='comment'># end
</span>      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'># no source cell
</span>
      <span class='comment'># Map each to their intersecting region and find the one with the largest duration.
</span>      <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span> <span class='op'>=</span>  <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span>
        <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d1'>d1</span> <span class='op'>=</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_r2'>r2</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>=</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='id identifier rubyid_d2'>d2</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_d1'>d1</span> <span class='comment'># largest first
</span>      <span class='kw'>end</span>
      <span class='id identifier rubyid_winner'>winner</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
        <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_winner'>winner</span><span class='period'>.</span><span class='id identifier rubyid_get_code'>get_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='comment'># p ncol.cells.size
</span>    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_ncol'>ncol</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="old_args=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="old_args-instance_method">
  
    #<strong>old_args</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute old_args</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 334</span>

<span class='kw'>def</span> <span class='id identifier rubyid_old_args'>old_args</span>
  <span class='ivar'>@old_args</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="type=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    #<strong>type</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute type</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 334</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type'>type</span>
  <span class='ivar'>@type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="sanitize_codename-class_method">
  
    .<strong>sanitize_codename</strong>(name)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Validate code name. Replace non-alphanumeric characters with underscores and prepend an underscore if the code starts with a number.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>string to validate</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>validated code name</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>1.3.6</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


346
347
348
349
350</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 346</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'>sanitize_codename</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sanitized'>sanitized</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(\W)+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='id identifier rubyid_sanitized'>sanitized</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^\d{1})</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_\\1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sanitized'>sanitized</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_code-instance_method">
  
    #<strong>add_code</strong>(name)  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='add_arg-instance_method'>add_arg</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a code to this column. Updates all cells in column with new code.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the name of the new code</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>nil</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


453
454
455
456
457
458
459
460
461
462
463</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 453</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_code'>add_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@old_args</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

  <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_san_name'>san_name</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
    <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_add_arg'>add_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="change_code_name-instance_method">
  
    #<strong>change_code_name</strong>(old_name, new_name)  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='change_arg_name-instance_method'>change_arg_name</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Changes the name of a code. Updates the name for all cells in the column</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>old_name</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the name of the argument you want to change</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>new_name</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the name you want to change old_name to</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>nil</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


433
434
435
436
437
438
439
440
441
442
443
444
445
446
447</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 433</span>

<span class='kw'>def</span> <span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
  <span class='ivar'>@old_args</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>

  <span class='comment'># Sanitize code
</span>  <span class='id identifier rubyid_old_name'>old_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_old_name'>old_name</span><span class='rparen'>)</span>
  <span class='ivar'>@arglist</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_name'>new_name</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
    <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_change_code_name'>change_code_name</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="convert_argname-instance_method">
  
    #<strong>convert_argname</strong>(arg)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


352
353
354</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 352</span>

<span class='kw'>def</span> <span class='id identifier rubyid_convert_argname'>convert_argname</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_cell-instance_method">
  
    #<strong>new_cell</strong>(cell = nil)  &#x21d2; <tt><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='make_new_cell-instance_method'>make_new_cell</span>, <span id='create_cell-instance_method'>create_cell</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a new, blank cell at the end of this variable&#39;s cell array. If a template cell is provided, copies over onset and offset times and code values for any matching code names.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_trial'>trial</span> <span class='op'>=</span> <span class='id identifier rubyid_get_column'><span class='object_link'><a href="top-level-namespace.html#get_column-instance_method" title="#get_column (method)">get_column</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trial</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_new_cell'>new_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_trial'>trial</span><span class='period'>.</span><span class='id identifier rubyid_new_cell'>new_cell</span><span class='lparen'>(</span><span class='rparen'>)</span>
<span class='id identifier rubyid_new_cell'>new_cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>1000</span>
<span class='id identifier rubyid_set_column'><span class='object_link'><a href="top-level-namespace.html#set_column-instance_method" title="#set_column (method)">set_column</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_trial'>trial</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cell</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>template cell</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Reference to the cell that was just created.  Modify the cell using this reference.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 402</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new_cell'>new_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_get_arg'>get_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
  <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_code-instance_method">
  
    #<strong>remove_code</strong>(name)  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='remove_arg-instance_method'>remove_arg</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove a code from this column. Updates all cells in column.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the name of the code to remove</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>nil</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


469
470
471
472
473
474
475
476
477
478
479
480</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 469</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_code'>remove_code</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@old_args</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_san_name'>san_name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@arglist</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>

  <span class='kw'>for</span> <span class='id identifier rubyid_cell'>cell</span> <span class='kw'>in</span> <span class='ivar'>@cells</span>
    <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_remove_arg'>remove_arg</span><span class='lparen'>(</span><span class='id identifier rubyid_san_name'>san_name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@dirty</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resample-instance_method">
  
    #<strong>resample</strong>(step, opts = {})  &#x21d2; <tt><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Undefined behavior for columns whose cells overlap with each other.</p>
</div>
  </div>


<p>Resamples the cells of this column using given step size. Optionally can specify the start and end time-points.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>step</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>step size to resample with, in milliseconds</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:column_name</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>self.name</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>name of returned column</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:start_time</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>earliest onset</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>time to start resampling from, in milliseconds</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:stop_time</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>latest offset</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>time to stop resampling at, in milliseconds</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>new column with resampled cells</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>1.3.6</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 500</span>

<span class='kw'>def</span> <span class='id identifier rubyid_resample'>resample</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@resample_defaults</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:column_name</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
    <span class='symbol'>:start_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:earliest</span><span class='comma'>,</span>
    <span class='symbol'>:stop_time</span> <span class='op'>=&gt;</span> <span class='symbol'>:latest</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@resample_defaults</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:earliest</span>
    <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:onset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:latest</span>
    <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@cells</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:offset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
  <span class='kw'>end</span>

  <span class='comment'># Construct new column
</span>  <span class='id identifier rubyid_ncol'>ncol</span> <span class='op'>=</span> <span class='id identifier rubyid_new_column'><span class='object_link'><a href="top-level-namespace.html#new_column-instance_method" title="#new_column (method)">new_column</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:column_name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
  <span class='comment'># Construct new cells spanning range.
</span>  <span class='lparen'>(</span> <span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_time</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:stop_time</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_step'>step</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_time'>time</span><span class='op'>|</span>
    <span class='id identifier rubyid_ncell'>ncell</span> <span class='op'>=</span> <span class='id identifier rubyid_ncol'>ncol</span><span class='period'>.</span><span class='id identifier rubyid_new_cell'>new_cell</span>
    <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span>
    <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>+</span> <span class='id identifier rubyid_step'>step</span> <span class='op'>-</span> <span class='int'>1</span>

    <span class='comment'># Find overlapping cells from self in this time region
</span>    <span class='id identifier rubyid_overlap_cells'>overlap_cells</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlaps_cell'>overlaps_cell</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='comment'># if overlap_cells.empty?
</span>    <span class='comment'>#   puts &quot;no source cell for time #{time}&quot;
</span>    <span class='comment'>#   next
</span>    <span class='comment'># end
</span>    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'># no source cell
</span>
    <span class='comment'># Map each to their intersecting region and find the one with the largest duration.
</span>    <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span> <span class='op'>=</span>  <span class='id identifier rubyid_overlap_cells'>overlap_cells</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span>
      <span class='id identifier rubyid_r1'>r1</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_d1'>d1</span> <span class='op'>=</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r1'>r1</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

      <span class='id identifier rubyid_r2'>r2</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_overlapping_region'>overlapping_region</span><span class='lparen'>(</span><span class='id identifier rubyid_ncell'>ncell</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_d2'>d2</span> <span class='op'>=</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='id identifier rubyid_r2'>r2</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

      <span class='id identifier rubyid_d2'>d2</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_d1'>d1</span> <span class='comment'># largest first
</span>    <span class='kw'>end</span>
    <span class='id identifier rubyid_winner'>winner</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_by_intersection'>sorted_by_intersection</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

    <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_code'>code</span><span class='op'>|</span>
      <span class='id identifier rubyid_ncell'>ncell</span><span class='period'>.</span><span class='id identifier rubyid_change_code'>change_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_winner'>winner</span><span class='period'>.</span><span class='id identifier rubyid_get_code'>get_code</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='comment'># p ncol.cells.size
</span>  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_ncol'>ncol</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_cells-instance_method">
  
    #<strong>set_cells</strong>(newcells, arglist)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This function is not for general use.</p>
</div>
  </div>


<p>Creates the cell object in the Variable object.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>newcells</span>
      
      
        <span class='type'>(<tt>required</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>: Array of cells coming from the database via get_column</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>arglist</span>
      
      
        <span class='type'>(<tt>required</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>: Array of the names of the arguments from the database</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 360</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_cells'>set_cells</span><span class='lparen'>(</span><span class='id identifier rubyid_newcells'>newcells</span><span class='comma'>,</span> <span class='id identifier rubyid_arglist'>arglist</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Setting cells</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@cells</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@arglist</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_arglist'>arglist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
    <span class='comment'># Regex to delete any character not a-z,0-9,or _
</span>    <span class='id identifier rubyid_print_debug'><span class='object_link'><a href="top-level-namespace.html#print_debug-instance_method" title="#print_debug (method)">print_debug</a></span></span> <span class='id identifier rubyid_arg'>arg</span>
    <span class='ivar'>@arglist</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="" title="RColumn (class)">RColumn</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_codename'><span class='object_link'><a href="#sanitize_codename-class_method" title="RColumn.sanitize_codename (method)">sanitize_codename</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_ord'>ord</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_newcells'>newcells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
      <span class='id identifier rubyid_ord'>ord</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RCell.html" title="RCell (class)">RCell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOnset'>getOnset</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getOffset'>getOffset</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_db_cell'>db_cell</span> <span class='op'>=</span> <span class='id identifier rubyid_cell'>cell</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='ivar'>@name</span>
      <span class='id identifier rubyid_vals'>vals</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getVariable'>getVariable</span><span class='period'>.</span><span class='id identifier rubyid_getRootNode'>getRootNode</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>Argument</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>MATRIX</span>
        <span class='kw'>for</span> <span class='id identifier rubyid_val'>val</span> <span class='kw'>in</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getArguments'>getArguments</span>
          <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_vals'>vals</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_getCellValue'>getCellValue</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_toString'>toString</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_args'>set_args</span><span class='lparen'>(</span><span class='id identifier rubyid_vals'>vals</span><span class='comma'>,</span> <span class='ivar'>@arglist</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_ordinal'>ordinal</span> <span class='op'>=</span> <span class='id identifier rubyid_ord'>ord</span>
      <span class='ivar'>@cells</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_hidden-instance_method">
  
    #<strong>set_hidden</strong>(value)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set hidden state of this column</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true to hide column in spreadsheet, false to show</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>nil</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


486
487
488</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 486</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_hidden'>set_hidden</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='ivar'>@hidden</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sort_cells-instance_method">
  
    #<strong>sort_cells</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sorts cells and saves column&#39;s cells by ascending onset times.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>nil</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


425
426
427</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'datavyu_api.rb', line 425</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sort_cells'>sort_cells</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_onset'>onset</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Sep  5 15:15:03 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.6.3).
</div>

    </div>
  </body>
</html>